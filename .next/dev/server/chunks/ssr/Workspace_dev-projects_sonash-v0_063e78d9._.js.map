{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jason/Workspace/dev-projects/sonash-v0/lib/firestore-service.ts"],"sourcesContent":["import { db } from \"./firebase\"\r\nimport {\r\n    collection,\r\n    doc,\r\n    setDoc,\r\n    getDoc,\r\n    getDocs,\r\n    query,\r\n    orderBy,\r\n    Timestamp,\r\n    limit\r\n} from \"firebase/firestore\"\r\n\r\n// Types\r\nexport interface DailyLog {\r\n    id?: string // Date string YYYY-MM-DD\r\n    date: string\r\n    content: string\r\n    mood: string | null\r\n    cravings: boolean\r\n    used: boolean\r\n    timestamp: any\r\n}\r\n\r\nexport const FirestoreService = {\r\n    // Save or update a daily log entry\r\n    async saveDailyLog(userId: string, data: Partial<DailyLog>) {\r\n        // Generate today's date string as ID (YYYY-MM-DD)\r\n        const today = new Date().toISOString().split('T')[0]\r\n        const docRef = doc(db, `users/${userId}/daily_logs/${today}`)\r\n\r\n        // Merge true allows us to update fields independently (e.g., autosave journal separate from check-in)\r\n        await setDoc(docRef, {\r\n            ...data,\r\n            id: today,\r\n            updatedAt: Timestamp.now()\r\n        }, { merge: true })\r\n    },\r\n\r\n    // Get today's log if it exists\r\n    async getTodayLog(userId: string) {\r\n        const today = new Date().toISOString().split('T')[0]\r\n        const docRef = doc(db, `users/${userId}/daily_logs/${today}`)\r\n        const docSnap = await getDoc(docRef)\r\n\r\n        if (docSnap.exists()) {\r\n            return docSnap.data() as DailyLog\r\n        }\r\n        return null\r\n    },\r\n\r\n    // Get history of logs\r\n    async getHistory(userId: string) {\r\n        const logsRef = collection(db, `users/${userId}/daily_logs`)\r\n        const q = query(logsRef, orderBy(\"id\", \"desc\"), limit(30))\r\n        const querySnapshot = await getDocs(q)\r\n\r\n        return querySnapshot.docs.map(doc => ({\r\n            ...doc.data(),\r\n            id: doc.id\r\n        })) as DailyLog[]\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAuBO,MAAM,mBAAmB;IAC5B,mCAAmC;IACnC,MAAM,cAAa,MAAc,EAAE,IAAuB;QACtD,kDAAkD;QAClD,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QACpD,MAAM,SAAS,IAAA,gUAAG,EAAC,qKAAE,EAAE,CAAC,MAAM,EAAE,OAAO,YAAY,EAAE,OAAO;QAE5D,sGAAsG;QACtG,MAAM,IAAA,mUAAM,EAAC,QAAQ;YACjB,GAAG,IAAI;YACP,IAAI;YACJ,WAAW,sUAAS,CAAC,GAAG;QAC5B,GAAG;YAAE,OAAO;QAAK;IACrB;IAEA,+BAA+B;IAC/B,MAAM,aAAY,MAAc;QAC5B,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QACpD,MAAM,SAAS,IAAA,gUAAG,EAAC,qKAAE,EAAE,CAAC,MAAM,EAAE,OAAO,YAAY,EAAE,OAAO;QAC5D,MAAM,UAAU,MAAM,IAAA,mUAAM,EAAC;QAE7B,IAAI,QAAQ,MAAM,IAAI;YAClB,OAAO,QAAQ,IAAI;QACvB;QACA,OAAO;IACX;IAEA,sBAAsB;IACtB,MAAM,YAAW,MAAc;QAC3B,MAAM,UAAU,IAAA,uUAAU,EAAC,qKAAE,EAAE,CAAC,MAAM,EAAE,OAAO,WAAW,CAAC;QAC3D,MAAM,IAAI,IAAA,kUAAK,EAAC,SAAS,IAAA,oUAAO,EAAC,MAAM,SAAS,IAAA,kUAAK,EAAC;QACtD,MAAM,gBAAgB,MAAM,IAAA,oUAAO,EAAC;QAEpC,OAAO,cAAc,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;gBAClC,GAAG,IAAI,IAAI,EAAE;gBACb,IAAI,IAAI,EAAE;YACd,CAAC;IACL;AACJ"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jason/Workspace/dev-projects/sonash-v0/app/history/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport Link from \"next/link\"\r\nimport { motion, AnimatePresence } from \"framer-motion\"\r\nimport { useAuth } from \"@/components/providers/auth-provider\"\r\nimport { FirestoreService } from \"@/lib/firestore-service\"\r\n\r\n// Mock data interfaces for now until Firestore is live\r\ninterface JournalEntry {\r\n    id: string\r\n    date: string\r\n    mood: string\r\n    content: string\r\n    cravings: boolean\r\n    used: boolean\r\n}\r\n\r\nexport default function HistoryPage() {\r\n    const { user } = useAuth()\r\n    const [entries, setEntries] = useState<any[]>([])\r\n\r\n    const [expandedId, setExpandedId] = useState<string | null>(null)\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            FirestoreService.getHistory(user.uid).then((data) => {\r\n                setEntries(data)\r\n            })\r\n        }\r\n    }, [user])\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#f5f0e6] p-4 font-sans text-amber-900\">\r\n            {/* Header */}\r\n            <div className=\"max-w-md mx-auto mb-8 pt-4 flex items-center justify-between\">\r\n                <h1 className=\"font-heading text-2xl\">My Journal</h1>\r\n                <Link\r\n                    href=\"/\"\r\n                    className=\"text-sm font-body underline decoration-amber-900/30 hover:text-amber-700\"\r\n                >\r\n                    Back to Book\r\n                </Link>\r\n            </div>\r\n\r\n            {/* Timeline List */}\r\n            <div className=\"max-w-md mx-auto space-y-4\">\r\n                {entries.map((entry) => (\r\n                    <motion.div\r\n                        key={entry.id}\r\n                        layout\r\n                        initial={{ opacity: 0, y: 10 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        className={`\r\n              bg-white/50 backdrop-blur-sm rounded-lg p-4 cursor-pointer transition-shadow\r\n              ${expandedId === entry.id ? 'shadow-md ring-1 ring-amber-200' : 'shadow-sm hover:shadow-md'}\r\n            `}\r\n                        onClick={() => setExpandedId(expandedId === entry.id ? null : entry.id)}\r\n                    >\r\n                        {/* Card Header */}\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <span className=\"font-heading text-lg\">{entry.date}</span>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                {entry.used && (\r\n                                    <span className=\"text-xs font-bold text-red-600 bg-red-100 px-2 py-0.5 rounded-full\">\r\n                                        RELAPSE\r\n                                    </span>\r\n                                )}\r\n                                {entry.cravings && !entry.used && (\r\n                                    <span className=\"text-xs font-bold text-amber-600 bg-amber-100 px-2 py-0.5 rounded-full\">\r\n                                        CRAVING\r\n                                    </span>\r\n                                )}\r\n                                <span className=\"text-xl\">{entry.mood}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Expanded Content */}\r\n                        <AnimatePresence>\r\n                            {expandedId === entry.id && (\r\n                                <motion.div\r\n                                    initial={{ height: 0, opacity: 0 }}\r\n                                    animate={{ height: \"auto\", opacity: 1 }}\r\n                                    exit={{ height: 0, opacity: 0 }}\r\n                                    className=\"overflow-hidden\"\r\n                                >\r\n                                    <div className=\"pt-3 border-t border-amber-900/10\">\r\n                                        <p className=\"font-handwriting text-xl leading-relaxed whitespace-pre-wrap text-blue-900/80\"\r\n                                            style={{ fontFamily: 'var(--font-caveat)' }}>\r\n                                            {entry.content}\r\n                                        </p>\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n                        </AnimatePresence>\r\n\r\n                        {/* Preview if not expanded */}\r\n                        {expandedId !== entry.id && (\r\n                            <p className=\"font-handwriting text-lg text-amber-900/40 truncate\"\r\n                                style={{ fontFamily: 'var(--font-caveat)' }}>\r\n                                {entry.content}\r\n                            </p>\r\n                        )}\r\n                    </motion.div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AACA;AACA;AANA;;;;;;;AAkBe,SAAS;IACpB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,uMAAO;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gYAAQ,EAAQ,EAAE;IAEhD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,gYAAQ,EAAgB;IAE5D,IAAA,iYAAS,EAAC;QACN,IAAI,MAAM;YACN,+LAAgB,CAAC,UAAU,CAAC,KAAK,GAAG,EAAE,IAAI,CAAC,CAAC;gBACxC,WAAW;YACf;QACJ;IACJ,GAAG;QAAC;KAAK;IAET,qBACI,6ZAAC;QAAI,WAAU;;0BAEX,6ZAAC;gBAAI,WAAU;;kCACX,6ZAAC;wBAAG,WAAU;kCAAwB;;;;;;kCACtC,6ZAAC,sVAAI;wBACD,MAAK;wBACL,WAAU;kCACb;;;;;;;;;;;;0BAML,6ZAAC;gBAAI,WAAU;0BACV,QAAQ,GAAG,CAAC,CAAC,sBACV,6ZAAC,6VAAM,CAAC,GAAG;wBAEP,MAAM;wBACN,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC7B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,WAAW,CAAC;;cAEtB,EAAE,eAAe,MAAM,EAAE,GAAG,oCAAoC,4BAA4B;YAC9F,CAAC;wBACW,SAAS,IAAM,cAAc,eAAe,MAAM,EAAE,GAAG,OAAO,MAAM,EAAE;;0CAGtE,6ZAAC;gCAAI,WAAU;;kDACX,6ZAAC;wCAAK,WAAU;kDAAwB,MAAM,IAAI;;;;;;kDAClD,6ZAAC;wCAAI,WAAU;;4CACV,MAAM,IAAI,kBACP,6ZAAC;gDAAK,WAAU;0DAAqE;;;;;;4CAIxF,MAAM,QAAQ,IAAI,CAAC,MAAM,IAAI,kBAC1B,6ZAAC;gDAAK,WAAU;0DAAyE;;;;;;0DAI7F,6ZAAC;gDAAK,WAAU;0DAAW,MAAM,IAAI;;;;;;;;;;;;;;;;;;0CAK7C,6ZAAC,qWAAe;0CACX,eAAe,MAAM,EAAE,kBACpB,6ZAAC,6VAAM,CAAC,GAAG;oCACP,SAAS;wCAAE,QAAQ;wCAAG,SAAS;oCAAE;oCACjC,SAAS;wCAAE,QAAQ;wCAAQ,SAAS;oCAAE;oCACtC,MAAM;wCAAE,QAAQ;wCAAG,SAAS;oCAAE;oCAC9B,WAAU;8CAEV,cAAA,6ZAAC;wCAAI,WAAU;kDACX,cAAA,6ZAAC;4CAAE,WAAU;4CACT,OAAO;gDAAE,YAAY;4CAAqB;sDACzC,MAAM,OAAO;;;;;;;;;;;;;;;;;;;;;4BAQjC,eAAe,MAAM,EAAE,kBACpB,6ZAAC;gCAAE,WAAU;gCACT,OAAO;oCAAE,YAAY;gCAAqB;0CACzC,MAAM,OAAO;;;;;;;uBAnDjB,MAAM,EAAE;;;;;;;;;;;;;;;;AA2DrC"}}]
}