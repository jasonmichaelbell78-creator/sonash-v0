{"dedup_id":"DEDUP-0001","original_ids":["CANON-0001","CANON-0043","CANON-0069"],"category":"Security","title":"App Check disabled on all Cloud Functions and client init disabled","severity":"S0","effort":"E2","status":"CONFIRMED","final_confidence":100,"consensus_score":5,"sources":["claude-sonnet-4.5","claude-code","opus","chatgpt"],"files":["functions/src/index.ts","lib/firebase.ts"],"symbols":["saveDailyLog","saveJournalEntry","requireAppCheck","initializeAppCheck"],"cross_category_notes":"Reported in CODE, SECURITY, and REFACTOR categories. Same root issue.","why_it_matters":"Bot/device attestation disabled on all endpoints, increasing abuse risk.","suggested_fix":"Re-enable App Check on functions + restore client init. Add monitoring for failures.","pr_bucket":"security-hardening","dependencies":["DEDUP-0003","DEDUP-0004"]}
{"dedup_id":"DEDUP-0002","original_ids":["CANON-0002","CANON-0034"],"category":"Security","title":"Legacy journalEntries collection allows direct client writes bypassing validation","severity":"S0","effort":"E2","status":"CONFIRMED","final_confidence":100,"consensus_score":4,"sources":["claude-sonnet-4.5","github-copilot","opus","chatgpt"],"files":["firestore.rules"],"symbols":["journalEntries"],"cross_category_notes":"Reported in CODE and SECURITY categories.","why_it_matters":"Direct writes bypass App Check, rate limiting, and server validation.","suggested_fix":"Migrate off legacy path, set allow write: if false.","pr_bucket":"security-hardening","dependencies":[]}
{"dedup_id":"DEDUP-0003","original_ids":["CANON-0008","CANON-0035"],"category":"Security","title":"reCAPTCHA verification logged but not enforced (fail-open)","severity":"S1","effort":"E1","status":"CONFIRMED","final_confidence":85,"consensus_score":3,"sources":["codex","opus"],"files":["functions/src/security-wrapper.ts"],"symbols":["withSecurityChecks"],"cross_category_notes":"Reported in CODE and SECURITY categories.","why_it_matters":"Missing tokens proceed, making bot protection ineffective.","suggested_fix":"Require token when recaptchaAction configured; fail closed.","pr_bucket":"security-hardening","dependencies":[]}
{"dedup_id":"DEDUP-0004","original_ids":["CANON-0036"],"category":"Security","title":"Rate limiting incomplete (no IP throttling, admin endpoints unthrottled)","severity":"S1","effort":"E2","status":"CONFIRMED","final_confidence":100,"consensus_score":4,"sources":["opus","chatgpt"],"files":["functions/src/security-wrapper.ts","functions/src/firestore-rate-limiter.ts","functions/src/admin.ts"],"symbols":[],"cross_category_notes":"SECURITY only but dependency of DEDUP-0001.","why_it_matters":"Higher DoS and abuse risk; unstable backoff signaling.","suggested_fix":"Add IP-based limiter; wrap admin callables with limiter.","pr_bucket":"security-hardening","dependencies":["DEDUP-0003"]}
{"dedup_id":"DEDUP-0005","original_ids":["CANON-0003","CANON-0042","CANON-0058"],"category":"Hygiene","title":"Console.* usage in production code bypasses standardized logger","severity":"S1","effort":"E1","status":"CONFIRMED","final_confidence":100,"consensus_score":5,"sources":["claude-sonnet-4.5","jules","claude-code","opus","chatgpt"],"files":["lib/db/library.ts","lib/firestore-service.ts","hooks/use-journal.ts","components/notebook/pages/today-page.tsx"],"symbols":["console.log","console.error","console.warn"],"cross_category_notes":"Reported in CODE, SECURITY, and PERF categories.","why_it_matters":"Potential info disclosure; inconsistent observability.","suggested_fix":"Replace with logger utility; add ESLint no-console rule.","pr_bucket":"security-hardening","dependencies":[]}
{"dedup_id":"DEDUP-0006","original_ids":["CANON-0004","CANON-0039","CANON-0067"],"category":"Types","title":"Journal entry type definitions diverge between client and server","severity":"S1","effort":"E0","status":"CONFIRMED","final_confidence":95,"consensus_score":4,"sources":["claude-sonnet-4.5","github-copilot","chatgpt"],"files":["types/journal.ts","functions/src/schemas.ts"],"symbols":["JournalEntryType","journalEntrySchema"],"cross_category_notes":"Reported in CODE, SECURITY, and REFACTOR categories.","why_it_matters":"step-1-worksheet entries fail server validation.","suggested_fix":"Add to server enum; establish single source of truth.","pr_bucket":"types-domain","dependencies":[]}
{"dedup_id":"DEDUP-0007","original_ids":["CANON-0006","CANON-0066","CANON-0087"],"category":"Hygiene","title":"Cloud Function error handling duplicated 4-6x with duplicate type definitions","severity":"S1","effort":"E1","status":"CONFIRMED","final_confidence":90,"consensus_score":4,"sources":["github-copilot","claude-code","codex","chatgpt"],"files":["lib/firestore-service.ts","hooks/use-journal.ts"],"symbols":["saveDailyLog","saveNotebookJournalEntry","addEntry","crumplePage","CloudFunctionError"],"cross_category_notes":"Reported in CODE and REFACTOR categories.","why_it_matters":"Error message changes require 4+ updates; CloudFunctionError defined twice in same file.","suggested_fix":"Extract handleCloudFunctionError() utility; single type definition.","pr_bucket":"hooks-standardization","dependencies":[]}
{"dedup_id":"DEDUP-0008","original_ids":["CANON-0007","CANON-0070"],"category":"Architecture","title":"Deprecated saveNotebookJournalEntry still used in 6+ UI components","severity":"S1","effort":"E2","status":"CONFIRMED","final_confidence":70,"consensus_score":2,"sources":["jules","codex","chatgpt"],"files":["lib/firestore-service.ts","components/growth/Step1WorksheetCard.tsx","components/notebook/pages/today-page.tsx"],"symbols":["saveNotebookJournalEntry","useJournal.addEntry"],"cross_category_notes":"Reported in CODE and REFACTOR categories.","why_it_matters":"Entries through deprecated path miss searchable metadata.","suggested_fix":"Migrate callers to useJournal.addEntry; remove deprecated method.","pr_bucket":"hooks-standardization","dependencies":["DEDUP-0006"]}
{"dedup_id":"DEDUP-0009","original_ids":["CANON-0017","CANON-0065"],"category":"Hygiene","title":"Time-of-day rotation logic duplicated in quotes.ts and slogans.ts","severity":"S2","effort":"E1","status":"CONFIRMED","final_confidence":95,"consensus_score":5,"sources":["codex","github-copilot","sonnet","opus","chatgpt"],"files":["lib/db/quotes.ts","lib/db/slogans.ts"],"symbols":["getTimeOfDay","getQuoteForNow","getSloganForNow"],"cross_category_notes":"Reported in CODE and REFACTOR categories.","why_it_matters":"80+ lines of identical rotation algorithm; bug fixes must be applied twice.","suggested_fix":"Extract to lib/utils/content-rotation.ts.","pr_bucket":"misc","dependencies":[]}
{"dedup_id":"DEDUP-0010","original_ids":["CANON-0023","CANON-0051","CANON-0073"],"category":"Hygiene","title":"DailyQuoteCard component duplicated across 2-3 locations","severity":"S2","effort":"E1","status":"CONFIRMED","final_confidence":90,"consensus_score":5,"sources":["claude-sonnet-4.5","codex","github-copilot","opus","chatgpt"],"files":["components/notebook/features/daily-quote-card.tsx","components/widgets/daily-quote-card.tsx","components/widgets/compact-daily-quote.tsx"],"symbols":["DailyQuoteCard","CompactDailyQuote"],"cross_category_notes":"Reported in CODE, PERF, and REFACTOR categories.","why_it_matters":"Same fetch logic repeated; feature changes must be applied 2-3 times.","suggested_fix":"Create useDailyQuote hook; single component with variant prop.","pr_bucket":"ui-primitives","dependencies":[]}
{"dedup_id":"DEDUP-0011","original_ids":["CANON-0044","CANON-0026"],"category":"Performance","title":"useJournal creates redundant auth listener + potential memory leak","severity":"S0","effort":"E1","status":"CONFIRMED","final_confidence":88,"consensus_score":5,"sources":["copilot","sonnet","opus","codex","chatgpt"],"files":["hooks/use-journal.ts","components/providers/auth-provider.tsx"],"symbols":["useJournal","onAuthStateChanged","onSnapshot"],"cross_category_notes":"Reported in PERF and CODE categories. Elevated to S0 due to memory leak.","why_it_matters":"Each hook instance creates own listener; nested cleanup may be ignored.","suggested_fix":"Remove auth listener; consume from useAuthCore(). Fix cleanup scope.","pr_bucket":"hooks-standardization","dependencies":[]}
{"dedup_id":"DEDUP-0012","original_ids":["CANON-0045","CANON-0033"],"category":"Performance","title":"Landing page forced to client-side rendering blocks SSR","severity":"S1","effort":"E2","status":"CONFIRMED","final_confidence":90,"consensus_score":5,"sources":["sonnet","opus","codex","chatgpt","jules"],"files":["app/page.tsx"],"symbols":["Home","NotebookShell","useState"],"cross_category_notes":"Reported in PERF and CODE categories.","why_it_matters":"Full landing page renders client-side; 20-40% LCP impact.","suggested_fix":"Split into server wrapper + client interactive parts.","pr_bucket":"boundaries","dependencies":[]}
{"dedup_id":"DEDUP-0013","original_ids":["CANON-0028","CANON-0037","CANON-0040"],"category":"Types","title":"Zod schemas permissive - missing .strict() and allows arbitrary nested data","severity":"S2","effort":"E2","status":"CONFIRMED","final_confidence":95,"consensus_score":4,"sources":["opus","chatgpt","github-copilot"],"files":["functions/src/schemas.ts"],"symbols":["journalEntrySchema","z.record"],"cross_category_notes":"Reported in CODE and SECURITY categories.","why_it_matters":"Unknown fields accepted; arbitrary payloads can be stored.","suggested_fix":"Add .strict(); use discriminated unions with per-type schemas.","pr_bucket":"types-domain","dependencies":[]}
{"dedup_id":"DEDUP-0014","original_ids":["CANON-0064"],"category":"Refactor","title":"47 CRITICAL cognitive complexity violations in scripts (19 functions)","severity":"S0","effort":"E3","status":"CONFIRMED","final_confidence":100,"consensus_score":3,"sources":["copilot","sonnet","opus"],"files":["scripts/assign-review-tier.js","scripts/phase-complete-check.js","scripts/suggest-pattern-automation.js","scripts/check-pattern-compliance.js"],"symbols":["assignReviewTier (38/15)","verifyDeliverable (27/15)"],"cross_category_notes":"REFACTOR only. SonarQube CRITICAL violations.","why_it_matters":"Functions exceeding 15-point threshold difficult to test and maintain.","suggested_fix":"Extract nested conditionals; use early returns; add tests first.","pr_bucket":"misc","dependencies":[]}
{"dedup_id":"DEDUP-0015","original_ids":["CANON-0105","CANON-0111"],"category":"Process","title":"CI quality gates non-blocking allowing regressions","severity":"S0","effort":"E2","status":"CONFIRMED","final_confidence":95,"consensus_score":5,"sources":["copilot","codex","sonnet","opus","chatgpt"],"files":[".github/workflows/ci.yml"],"symbols":["continue-on-error"],"cross_category_notes":"PROCESS only. 93+ pattern violations pass CI.","why_it_matters":"Quality regressions escape to main; tech debt accumulates.","suggested_fix":"Convert to diff-based blocking; track baseline; burn down over time.","pr_bucket":"process","dependencies":[]}
