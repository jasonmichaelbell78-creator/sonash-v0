{
  "generated": "2026-01-11",
  "aggregator": "Claude Opus 4.5",
  "mode": "TIER-2",
  "total_findings": 97,
  "prs": [
    {
      "pr_id": "PR1",
      "title": "fix: resolve useJournal memory leak and auth listener redundancy",
      "goal": "Fix S0 memory leak by removing redundant auth listener from useJournal hook",
      "categories_involved": ["PERF", "CODE"],
      "included_canonical_ids": ["CANON-0044", "CANON-0026"],
      "included_dedup_ids": ["DEDUP-0011"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["npm test", "npm run lint", "Navigate away/back - verify single listener", "React DevTools shows fewer renders"],
      "notes": "Memory leak potential - prioritize. Refactor to consume user from useAuthCore()."
    },
    {
      "pr_id": "PR2",
      "title": "fix: close legacy journalEntries direct write path",
      "goal": "Migrate off legacy Firestore path and deny direct writes to prevent bypassing validation",
      "categories_involved": ["SECURITY", "CODE"],
      "included_canonical_ids": ["CANON-0002", "CANON-0034"],
      "included_dedup_ids": ["DEDUP-0002"],
      "staging": ["PR2a-migrate-data", "PR2b-update-rules"],
      "risk_level": "high",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["Attempt direct client write to legacy path - denied", "All journal writes succeed via secured path", "npm test"],
      "notes": "Data migration required before rule change. Verify no active usage of legacy path."
    },
    {
      "pr_id": "PR3",
      "title": "fix: make reCAPTCHA enforcement fail-closed",
      "goal": "Require valid reCAPTCHA token when configured, reject missing tokens",
      "categories_involved": ["SECURITY", "CODE"],
      "included_canonical_ids": ["CANON-0008", "CANON-0035"],
      "included_dedup_ids": ["DEDUP-0003"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["Requests without token rejected", "Valid tokens succeed", "Low-score tokens rejected per policy"],
      "notes": "Allow bypass only in explicit dev/test modes."
    },
    {
      "pr_id": "PR4",
      "title": "fix: complete rate limiting with IP throttling and admin endpoints",
      "goal": "Add IP-based throttling and protect admin endpoints",
      "categories_involved": ["SECURITY"],
      "included_canonical_ids": ["CANON-0036", "CANON-0015"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E2",
      "prerequisites": ["PR3"],
      "acceptance_tests": ["Burst calls produce resource-exhausted", "Account cycling triggers IP limiter", "Admin callables throttle under burst"],
      "notes": "Secondary limiter keyed by IP in addition to userId."
    },
    {
      "pr_id": "PR5",
      "title": "fix: convert CI quality gates to blocking",
      "goal": "Make pattern compliance, docs checks, and formatting block PRs with regressions",
      "categories_involved": ["PROCESS"],
      "included_canonical_ids": ["CANON-0105", "CANON-0111"],
      "staging": ["PR5a-diff-based-check", "PR5b-remove-continue-on-error"],
      "risk_level": "low",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["PR with pattern violation fails CI", "Baseline violations tracked", "No false positives on unchanged files"],
      "notes": "Implement diff-based blocking first, then burn down baseline."
    },
    {
      "pr_id": "PR6",
      "title": "fix: add step-1-worksheet to server journal entry schema",
      "goal": "Align client/server type enums for journal entry types",
      "categories_involved": ["CODE", "SECURITY", "REFACTOR"],
      "included_canonical_ids": ["CANON-0004", "CANON-0039", "CANON-0067"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E0",
      "prerequisites": [],
      "acceptance_tests": ["step-1-worksheet saves succeed", "npm run build passes", "cd functions && npm run build passes"],
      "notes": "Quick win. Establish single source of truth for future."
    },
    {
      "pr_id": "PR7",
      "title": "refactor: extract Cloud Function error handling utility",
      "goal": "Consolidate duplicated error handling into reusable helper",
      "categories_involved": ["CODE", "REFACTOR"],
      "included_canonical_ids": ["CANON-0006", "CANON-0066", "CANON-0087"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["npm test passes", "Error messages consistent", "Single CloudFunctionError definition"],
      "notes": "Create lib/utils/callable-errors.ts with handleCloudFunctionError()."
    },
    {
      "pr_id": "PR8",
      "title": "refactor: replace console logging with structured logger",
      "goal": "Eliminate console.* in production code paths",
      "categories_involved": ["CODE", "SECURITY", "PERF"],
      "included_canonical_ids": ["CANON-0003", "CANON-0042", "CANON-0058"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["grep console.* in production paths returns 0", "Production builds emit no console logs", "npm run lint passes"],
      "notes": "Add ESLint no-console rule after migration."
    },
    {
      "pr_id": "PR9",
      "title": "refactor: consolidate DailyQuoteCard and extract hook",
      "goal": "Single DailyQuoteCard with variants, shared useDailyQuote hook",
      "categories_involved": ["CODE", "PERF", "REFACTOR"],
      "included_canonical_ids": ["CANON-0023", "CANON-0051", "CANON-0073"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["Quote displays correctly in all contexts", "Network shows single quote fetch", "Bundle size reduced"],
      "notes": "Delete features/ version, keep widgets version with variant prop."
    },
    {
      "pr_id": "PR10",
      "title": "refactor: extract time-of-day rotation utilities",
      "goal": "DRY rotation logic between quotes and slogans services",
      "categories_involved": ["CODE", "REFACTOR"],
      "included_canonical_ids": ["CANON-0017", "CANON-0065"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["npm test passes", "Quotes and slogans rotate correctly"],
      "notes": "Create lib/utils/content-rotation.ts."
    },
    {
      "pr_id": "PR11",
      "title": "refactor: create callSecureFunction wrapper with auto reCAPTCHA",
      "goal": "Centralize reCAPTCHA token injection and retry logic",
      "categories_involved": ["REFACTOR", "SECURITY"],
      "included_canonical_ids": ["CANON-0076", "CANON-0078"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E1",
      "prerequisites": ["PR3"],
      "acceptance_tests": ["All Cloud Function calls use wrapper", "npm test passes"],
      "notes": "Extract shared reCAPTCHA action constants too."
    },
    {
      "pr_id": "PR12",
      "title": "refactor: create typed Firestore collection helpers",
      "goal": "Type-safe collection access to prevent typos and enable refactoring",
      "categories_involved": ["REFACTOR"],
      "included_canonical_ids": ["CANON-0077", "CANON-0080"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["Type checking catches collection name typos", "npm run build passes"],
      "notes": "Create lib/firestore-collections.ts."
    },
    {
      "pr_id": "PR13",
      "title": "perf: enable SSR for landing page",
      "goal": "Split landing page for server rendering of static content",
      "categories_involved": ["PERF", "CODE"],
      "included_canonical_ids": ["CANON-0045", "CANON-0033"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["View source shows rendered HTML", "Lighthouse FCP/LCP improved", "No hydration errors"],
      "notes": "Move NotebookShell behind dynamic import."
    },
    {
      "pr_id": "PR14",
      "title": "perf: reduce use client directives for SSR optimization",
      "goal": "Convert pages to server components with client children",
      "categories_involved": ["PERF"],
      "included_canonical_ids": ["CANON-0046"],
      "staging": ["PR14a-pages", "PR14b-components"],
      "risk_level": "medium",
      "estimated_effort": "E2",
      "prerequisites": ["PR13"],
      "acceptance_tests": ["Count 'use client' < 50", "LCP improved", "No hydration errors"],
      "notes": "Target: reduce from 88-94 to <50 client directives."
    },
    {
      "pr_id": "PR15",
      "title": "perf: add virtualization to large list components",
      "goal": "Implement virtual scrolling for journal/timeline/meetings lists",
      "categories_involved": ["PERF"],
      "included_canonical_ids": ["CANON-0055", "CANON-0056"],
      "staging": [],
      "risk_level": "medium",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["DOM shows <20 entries regardless of total", "Scroll smooth with 100+ entries", "Memory reduced"],
      "notes": "Use react-window or @tanstack/virtual."
    },
    {
      "pr_id": "PR16",
      "title": "docs: fix broken links and replace placeholders",
      "goal": "Resolve documentation link rot and stale placeholders",
      "categories_involved": ["DOCS"],
      "included_canonical_ids": ["CANON-0091", "CANON-0092", "CANON-0095", "CANON-0098", "CANON-0099"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["Link validation passes", "grep [X] returns 0 matches", "No duplicate plan files"],
      "notes": "Batch all doc fixes together."
    },
    {
      "pr_id": "PR17",
      "title": "test: add coverage for high-complexity scripts",
      "goal": "Reduce regression risk for workflow-critical scripts",
      "categories_involved": ["PROCESS", "REFACTOR"],
      "included_canonical_ids": ["CANON-0106", "CANON-0068"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["Script test suite runs in CI", "Coverage >70% for priority scripts"],
      "notes": "Start with update-readme-status.js, validate-phase-completion.js, check-docs-light.js."
    },
    {
      "pr_id": "PR18",
      "title": "refactor: reduce cognitive complexity in scripts",
      "goal": "Refactor 47 CRITICAL complexity violations to <15 per function",
      "categories_involved": ["REFACTOR"],
      "included_canonical_ids": ["CANON-0064"],
      "staging": ["PR18a-assign-review-tier", "PR18b-phase-complete-check", "PR18c-other-scripts"],
      "risk_level": "medium",
      "estimated_effort": "E3",
      "prerequisites": ["PR17"],
      "acceptance_tests": ["SonarQube complexity < 15 for all functions", "npm test passes"],
      "notes": "Add tests before refactoring. Use early returns and helper extraction."
    },
    {
      "pr_id": "PR-BATCH-AUTO",
      "title": "chore: apply SonarQube auto-fixes",
      "goal": "Address ~317 auto-fixable SonarQube issues",
      "categories_involved": ["REFACTOR"],
      "included_canonical_ids": ["CANON-0088", "CANON-0089"],
      "staging": [],
      "risk_level": "low",
      "estimated_effort": "E1",
      "prerequisites": [],
      "acceptance_tests": ["npm run build passes", "SonarQube issue count reduced by ~300"],
      "notes": "Array.at(), replaceAll(), unused imports, node: prefix. Run npm run lint:fix first."
    },
    {
      "pr_id": "PR-BATCH-MANUAL",
      "title": "refactor: address remaining SonarQube issues",
      "goal": "Fix ~170 issues requiring manual refactoring",
      "categories_involved": ["REFACTOR"],
      "included_canonical_ids": ["CANON-0083"],
      "staging": ["PR-BATCH-MANUAL-a", "PR-BATCH-MANUAL-b"],
      "risk_level": "medium",
      "estimated_effort": "E2",
      "prerequisites": ["PR-BATCH-AUTO"],
      "acceptance_tests": ["Nested ternaries replaced", "Deprecated APIs updated", "npm test passes"],
      "notes": "Nested ternaries (41), deprecated APIs (31), shell scripts (47)."
    },
    {
      "pr_id": "PR-LINT-WARNINGS",
      "title": "fix: address ESLint security warnings",
      "goal": "Resolve 246 security plugin warnings",
      "categories_involved": ["CODE", "SECURITY"],
      "included_canonical_ids": ["CANON-0019"],
      "staging": ["PR-LINT-a-fs", "PR-LINT-b-injection", "PR-LINT-c-regex"],
      "risk_level": "low",
      "estimated_effort": "E2",
      "prerequisites": [],
      "acceptance_tests": ["ESLint warnings reduced to <50", "No false positives introduced"],
      "notes": "detect-non-literal-fs (~100), detect-object-injection (~80), detect-unsafe-regex (~30)."
    }
  ],
  "execution_order": [
    "PR1", "PR2", "PR3", "PR4", "PR5", "PR6", "PR7", "PR8",
    "PR-BATCH-AUTO", "PR9", "PR10", "PR11", "PR12",
    "PR13", "PR14", "PR15", "PR16", "PR17", "PR18",
    "PR-BATCH-MANUAL", "PR-LINT-WARNINGS"
  ],
  "parallel_groups": [
    ["PR1", "PR3", "PR5", "PR6"],
    ["PR7", "PR8", "PR-BATCH-AUTO"],
    ["PR9", "PR10", "PR12", "PR16"],
    ["PR13", "PR15", "PR17"],
    ["PR-BATCH-MANUAL", "PR-LINT-WARNINGS"]
  ]
}
