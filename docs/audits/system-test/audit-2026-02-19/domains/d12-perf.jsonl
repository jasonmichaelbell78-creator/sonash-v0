{"id":"SYST-2026-02-19-D12-001","domain":12,"domain_name":"Performance","check_id":"12.2","severity":"S2","effort":"E2","category":"performance","title":"Image optimization disabled — no alternative optimization for static export","description":"next.config.mjs sets images.unoptimized: true which disables all Next.js Image Optimization (responsive sizing, WebP conversion, lazy loading optimization). This is required for output: 'export' (Firebase Hosting static deployment) because Next.js Image Optimization needs a server. However, no alternative image optimization pipeline exists — images are served at original size on all devices.","recommendation":"Add a build-time image optimization step using sharp or next-optimized-images, or use a CDN with image transformation (e.g., Firebase Extensions Image Resizing).","file":"next.config.mjs","line":14,"evidence":"next.config.mjs:14-16 — images: { unoptimized: true } disables all Next.js image optimization\noutput: 'export' (line 13) requires unoptimized: true since no server for on-demand optimization\ncomponents/notebook/book-cover.tsx uses next/image with fill and sizes props but optimization is bypassed","suggested_fix":"Add build-time image optimization: (1) Use sharp in a prebuild script to generate responsive sizes, (2) Or use Firebase Extensions 'Resize Images' to auto-generate thumbnails on upload, (3) Or switch to a CDN with image transformation (Cloudinary, imgix). The next/image component still handles responsive rendering even with unoptimized: true.","status":"accepted","suggestion_text":"Accept at S2. Image optimization is disabled globally with no alternative. Mobile users load full-size images on constrained connections.","counter_argument":"The app has very few images (notebook cover, icons). Most content is text-based journal entries. The performance impact is minimal for the current image set.","related_findings":[],"detected_at":"2026-02-19T14:30:00Z","reviewed_at":"2026-02-19T14:35:00Z"}
{"id":"SYST-2026-02-19-D12-002","domain":12,"domain_name":"Performance","check_id":"12.4","severity":"S2","effort":"E1","category":"performance","title":"Multiple unbounded Firestore queries without limit() — deprecated getAllMeetings still accessible","description":"Several Firestore queries fetch entire collections without limit(): (1) MeetingsService.getAllMeetings() fetches all meetings (marked @deprecated but still exported), (2) SoberLivingService.getAllHomes() fetches all sober_living docs, (3) GlossaryService.getAllTerms() fetches all glossary docs. While paginated alternatives exist for meetings, the deprecated method is still importable and the other services have no pagination.","recommendation":"Remove deprecated getAllMeetings() or make it private. Add limit() to getAllHomes() and getAllTerms() queries.","file":"lib/db/meetings.ts","line":133,"evidence":"lib/db/meetings.ts:133-155 — getAllMeetings() uses getDocs(meetingsRef) with no limit (marked @deprecated)\nlib/db/sober-living.ts:30-34 — getAllHomes() uses query(collection(db, COLLECTION)) with no limit\nlib/db/glossary.ts:25-29 — getAllTerms() uses query(collection(db, COLLECTION)) with no limit\nContrast: meetings.ts:165-214 — getAllMeetingsPaginated() properly uses limit(pageSize)","suggested_fix":"(1) Remove or make private the deprecated getAllMeetings(). (2) Add limit(200) to getAllHomes(). (3) Add limit(500) to getAllTerms(). These are admin-managed collections unlikely to exceed these limits, but the guard prevents runaway queries.","status":"accepted","suggestion_text":"Accept at S2. Unbounded queries on public collections risk OOM and high Firestore read costs if data grows unexpectedly.","counter_argument":"These are admin-managed seed datasets. Meetings has a paginated alternative already in use. Glossary and sober living are small static datasets unlikely to grow beyond 100 docs.","related_findings":["D09-004"],"detected_at":"2026-02-19T14:30:00Z","reviewed_at":"2026-02-19T14:35:00Z"}
{"id":"SYST-2026-02-19-D12-003","domain":12,"domain_name":"Performance","check_id":"12.6","severity":"S3","effort":"E1","category":"performance","title":"Inline SVG data URIs in style props for book texture effects","description":"book-cover.tsx and notebook-shell.tsx embed large SVG noise textures as data URIs in inline style props. These are re-serialized on every render and increase component size. The SVGs generate fractalNoise patterns used for paper texture effects.","file":"components/notebook/book-cover.tsx","line":246,"evidence":"book-cover.tsx:246-251 — backgroundImage: url(data:image/svg+xml,...) with fractalNoise SVG\nnotebook-shell.tsx:223-228 — similar inline SVG texture pattern\nBoth use style props causing new object creation per render","suggested_fix":"Extract SVG textures to static CSS classes or separate .svg files in /public. Reference via className instead of inline style. This avoids re-serialization and enables browser caching.","status":"accepted","suggestion_text":"Accept at S3. Minor performance impact. Inline SVGs add to component weight and prevent caching but the visual effect is important for the notebook metaphor.","counter_argument":"The SVGs are small (< 500 bytes encoded). Extracting to files adds build complexity. The notebook texture is a core design element that benefits from inline definition for maintainability.","related_findings":[],"detected_at":"2026-02-19T14:30:00Z","reviewed_at":"2026-02-19T14:35:00Z"}
{"id":"SYST-2026-02-19-D12-004","domain":12,"domain_name":"Performance","check_id":"12.8","severity":"S3","effort":"E0","category":"performance","title":"All 117+ components marked 'use client' — redundant when parent is already client component","description":"Every component file includes 'use client' directive at line 1, even leaf components rendered inside already-client parent components. When a parent component is 'use client', all its children are automatically client components. The redundant directives add noise and prevent any future optimization with Server Components.","file":"components/notebook/book-cover.tsx","line":1,"evidence":"All 117+ component files start with 'use client' directive\nbook-cover.tsx:1 — 'use client' (parent of dynamic child components)\nnotebook-shell.tsx:1 — 'use client' (child of book-cover)\nAll leaf components like enhanced-mood-selector.tsx:1 — 'use client' (already inside client tree)","suggested_fix":"Informational. With output: 'export', Server Components are not available anyway. If migrating to SSR in the future, audit and remove redundant 'use client' directives from leaf components that don't use hooks or browser APIs.","status":"accepted","suggestion_text":"Accept at S3. No functional impact with static export. Informational for future SSR migration.","counter_argument":"With output: 'export', all components are client components regardless. The directive is harmless and provides clarity about component requirements. Removing them provides zero benefit in current architecture.","related_findings":[],"detected_at":"2026-02-19T14:30:00Z","reviewed_at":"2026-02-19T14:35:00Z"}
