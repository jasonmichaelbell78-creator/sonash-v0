{"id":"SYST-2026-02-19-D15-001","domain":15,"domain_name":"PWA & Offline","check_id":"15.2","severity":"S1","effort":"E3","category":"correctness","title":"No service worker — app cannot function offline despite PWA manifest and install prompt","description":"The app has a manifest.json, install prompt (components/pwa/install-prompt.tsx), and offline indicator (components/status/offline-indicator.tsx), but no service worker exists. No sw.js, service-worker.js, or workbox config found. No PWA packages (workbox, next-pwa) in dependencies. Users who install the PWA cannot use it offline — they get a blank/error page.","file":"public/manifest.json","line":1,"evidence":["No service worker files found (sw.js, service-worker.js — 0 results)","No navigator.serviceWorker registration code in codebase","No workbox, next-pwa, or serwist packages in package.json","manifest.json exists with display: standalone — installable but not offline-capable","components/pwa/install-prompt.tsx exists and uses beforeinstallprompt correctly"],"confidence":"HIGH","recommendation":"Implement a service worker using Workbox or Serwist for precaching the app shell and providing offline fallback.","verification_steps":{"first_pass":{"method":"grep","evidence_collected":["grep serviceWorker — 0 results in app code","grep sw.js — 0 results","glob public/sw*.js — 0 results"]},"second_pass":{"method":"contextual_review","confirmed":true},"tool_confirmation":{"tool":"NONE","result":"confirmed — no service worker implementation exists despite PWA manifest and install prompt","reference":"public/manifest.json, package.json"}},"suggested_fix":"Add a service worker with Workbox: (1) Install serwist or workbox-webpack-plugin, (2) Configure precaching for app shell (/index.html, CSS, JS), (3) Add runtime caching for Firestore API calls, (4) Create offline fallback page. Consider serwist which integrates well with Next.js static exports.","status":"accepted","suggestion_text":"Accept at S1. PWA is installable but broken offline. The offline indicator misleads users by saying 'changes will sync when reconnected' — there's no sync mechanism.","counter_argument":"The app primarily works with real-time Firestore data that requires network connectivity. Offline PWA support adds significant complexity. Many Firebase apps ship without service workers initially.","related_findings":["D15-002","D15-003"],"detected_at":"2026-02-19T15:10:00Z","reviewed_at":"2026-02-19T15:15:00Z"}
{"id":"SYST-2026-02-19-D15-002","domain":15,"domain_name":"PWA & Offline","check_id":"15.5","severity":"S2","effort":"E1","category":"correctness","title":"No Firestore offline persistence — offline indicator promises sync that cannot happen","description":"Firebase Firestore is initialized without enableIndexedDbPersistence() or enablePersistence(). The offline indicator component displays 'Offline - changes will sync when reconnected' but there is no persistence layer to queue offline writes. Any Firestore writes attempted while offline will fail silently or throw errors.","recommendation":"Enable Firestore offline persistence with enableIndexedDbPersistence(db) or the newer persistentLocalCache config.","file":"lib/firebase.ts","line":54,"evidence":"lib/firebase.ts — _db = getFirestore(_app) with no enableIndexedDbPersistence() call\nGrep for enablePersistence: 0 results\nGrep for enableIndexedDbPersistence: 0 results\ncomponents/status/offline-indicator.tsx:45-51 — displays 'changes will sync when reconnected'","suggested_fix":"Add Firestore offline persistence: import { initializeFirestore, persistentLocalCache } from 'firebase/firestore'; _db = initializeFirestore(_app, { localCache: persistentLocalCache() }); This enables automatic IndexedDB caching and write queueing.","status":"accepted","suggestion_text":"Accept at S2. The offline indicator misleads users. Either enable persistence or change the offline message to 'You are offline. Changes cannot be saved.'","counter_argument":"Enabling Firestore persistence adds IndexedDB storage overhead and can cause cache consistency issues in multi-tab scenarios. The app may intentionally avoid offline writes to prevent data conflicts.","related_findings":["D15-001"],"detected_at":"2026-02-19T15:10:00Z","reviewed_at":"2026-02-19T15:15:00Z"}
{"id":"SYST-2026-02-19-D15-003","domain":15,"domain_name":"PWA & Offline","check_id":"15.1","severity":"S3","effort":"E0","category":"correctness","title":"PWA manifest icon sizes mismatch — declares 192x192/512x512 but file is 1024x1024 JPEG","description":"public/manifest.json declares icon sizes '192x192 512x512' but references a single file /pwa-icon.jpg. The actual file is 1024x1024 pixels. Browsers expect the declared sizes to match actual file dimensions. Additionally, using JPEG instead of PNG means no transparency support. Best practice is separate files for each size.","recommendation":"Generate properly-sized icon files (192x192.png and 512x512.png) and update manifest.json to reference them separately.","file":"public/manifest.json","line":11,"evidence":"manifest.json:11-15 — sizes: '192x192 512x512' but file is /pwa-icon.jpg (single 1024x1024 file)\nmanifest.json:16-19 — second entry with sizes: 'any' also references same file\nJPEG format lacks transparency — PNG preferred for PWA icons","suggested_fix":"Generate separate icon files: pwa-icon-192.png (192x192) and pwa-icon-512.png (512x512). Update manifest.json to list each separately with correct sizes and type: 'image/png'.","status":"accepted","suggestion_text":"Accept at S3. Icon mismatch may cause install issues on some browsers. Low impact but easy fix.","counter_argument":"Most browsers handle oversized icons by downscaling. The 'any' size entry provides fallback. JPEG icons work on all major browsers.","related_findings":["D15-001"],"detected_at":"2026-02-19T15:10:00Z","reviewed_at":"2026-02-19T15:15:00Z"}
