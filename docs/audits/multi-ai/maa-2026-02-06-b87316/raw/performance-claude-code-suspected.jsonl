{"category":"Rendering","title":"EntryCard in timeline.tsx creates new arrow functions on each render","fingerprint":"Rendering::components/journal/timeline.tsx::inline_callbacks","severity":"S3","effort":"E1","confidence":35,"files":["components/journal/timeline.tsx"],"line":99,"symbols":["Timeline","EntryCard"],"performance_details":{"current_metric":"timeline.tsx:99 passes onClick={() => setSelectedEntry(entry)} as inline arrow function to EntryCard on every render. If EntryCard uses React.memo, this defeats memoization.","expected_improvement":"Minimal unless EntryCard is memoized - would prevent unnecessary re-renders of entry cards","affected_metric":"render"},"optimization":{"description":"Check if EntryCard is wrapped in React.memo. If so, extract the onClick handler using useCallback or pass entry.id and handle selection in parent.","verification":["Check if EntryCard uses React.memo","Profile re-renders in React DevTools"]},"evidence":["components/journal/timeline.tsx:99: onClick={() => setSelectedEntry(entry)} - inline arrow in map"]}
{"category":"Data Fetching","title":"Firestore client-side filtering of soft-deleted entries","fingerprint":"Data Fetching::hooks/use-journal.ts::client_side_filter","severity":"S3","effort":"E1","confidence":30,"files":["hooks/use-journal.ts"],"line":174,"symbols":["processJournalDoc"],"performance_details":{"current_metric":"processJournalDoc (line 174) filters out soft-deleted entries client-side. A Firestore where clause could exclude these server-side, but the code comments explain this avoids a composite index requirement.","expected_improvement":"Marginal - depends on ratio of soft-deleted to total entries","affected_metric":"render"},"optimization":{"description":"Add a composite index for isSoftDeleted + createdAt to enable server-side filtering. This would reduce data transferred for users with many soft-deleted entries.","verification":["Check how many entries are soft-deleted vs total per user"]},"evidence":["hooks/use-journal.ts:174: if (data.isSoftDeleted === true) return null;","hooks/use-journal.ts:275-276: Comment explains composite index avoidance"]}
{"category":"Bundle Size","title":"date-fns may not be tree-shaken effectively","fingerprint":"Bundle Size::package.json::date_fns_treeshake","severity":"S3","effort":"E1","confidence":25,"files":["package.json","components/journal/entry-feed.tsx","components/notebook/pages/today-page.tsx"],"line":90,"symbols":["date-fns"],"performance_details":{"current_metric":"date-fns ^4.1.0 is imported in multiple files. date-fns v4 supports tree-shaking natively, but barrel imports like 'import { format, subDays } from \"date-fns\"' may include more than needed depending on bundler config.","expected_improvement":"Potentially 10-20KB savings if using direct path imports","affected_metric":"bundle"},"optimization":{"description":"Verify tree-shaking is effective for date-fns by checking the bundle analyzer. If not, switch to direct path imports: import format from 'date-fns/format'.","verification":["Check date-fns size in bundle analyzer"]},"evidence":["today-page.tsx:7: import { intervalToDuration, subDays, startOfDay, format, differenceInDays } from 'date-fns'","entry-feed.tsx:19: import { format } from 'date-fns'"]}
