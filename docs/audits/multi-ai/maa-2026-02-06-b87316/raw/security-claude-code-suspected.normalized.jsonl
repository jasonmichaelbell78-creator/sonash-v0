{"category":"InputValidation","title":"Journal/inventory data field accepts arbitrary nested objects","fingerprint":"InputValidation::functions/src/schemas.ts::flexible_data_field","severity":"S3","effort":"E2","confidence":35,"files":["functions/src/schemas.ts"],"line":32,"vulnerability_details":{"description":"journalEntrySchema (line 32) and inventoryEntrySchema (line 51) define data: z.record(z.string(), z.unknown()), allowing arbitrary nested object structures of unlimited depth and size. While the content string field has a 50KB limit, the data field has no size constraint.","exploitation":"An attacker could send deeply nested or very large objects in the data field, potentially causing Firestore write size limit errors or consuming excessive storage.","impact":"Potential for oversized Firestore documents. Firestore has a 1MB document size limit which provides a natural ceiling, but processing large payloads could impact function execution time.","affected_data":"Journal and inventory entry data"},"remediation":{"steps":["1. Add a JSON.stringify(data).length check in the Cloud Function handler before Firestore write","2. Consider adding per-type Zod schemas for the data field","3. Set a reasonable max like 100KB for the serialized data field"],"verification":["Send request with 500KB data object, verify it is rejected gracefully"]},"owasp_category":"A03","cvss_estimate":"LOW","evidence":["functions/src/schemas.ts:32: data: z.record(z.string(), z.unknown()),","functions/src/schemas.ts:51: data: z.record(z.string(), z.unknown()),"]}
{"category":"SecretsManagement","title":"functions/.env committed to git","fingerprint":"SecretsManagement::functions/.env::committed","severity":"S3","effort":"E0","confidence":30,"files":["functions/.env"],"line":1,"vulnerability_details":{"description":"functions/.env is tracked in git. Current contents are non-sensitive: SENTRY_ORG=sonash, SENTRY_PROJECT=javascript-nextjs, and a comment referencing AUTH_REST_API_KEY stored in GCP Secret Manager. No actual secrets are committed.","exploitation":"Not exploitable with current contents. The file explicitly documents that the actual API key is stored in GCP Secret Manager (line 9). Risk is future accidental addition of secrets.","impact":"None currently. Organizational risk only.","affected_data":"Sentry organization and project names (public information)"},"remediation":{"steps":["1. Consider renaming to functions/.env.example and adding functions/.env to .gitignore","2. Or add a comment header warning not to add secrets"],"verification":["Verify functions/.env contains no actual secret values"]},"owasp_category":"A05","cvss_estimate":"LOW","evidence":["functions/.env:6: SENTRY_ORG=sonash","functions/.env:7: SENTRY_PROJECT=javascript-nextjs","functions/.env:9: # Firebase Web API Key - stored in GCP Secret Manager","git ls-files output includes: functions/.env"]}