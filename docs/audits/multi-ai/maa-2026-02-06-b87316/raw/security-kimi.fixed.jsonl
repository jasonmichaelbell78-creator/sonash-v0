{"category":"Firebase","title":"App Check temporarily disabled in all Cloud Functions","fingerprint":"Firebase::functions/src/index.ts::app_check_disabled","severity":"S2","effort":"E1","confidence":100,"files":["functions/src/index.ts","functions/src/security-wrapper.ts"],"line":1,"vulnerability_details":{"description":"All callable Cloud Functions have App Check verification disabled via requireAppCheck: false. This removes an important bot protection layer.","exploitation":"Attackers can call Cloud Functions from non-authenticated apps or scripts, bypassing app attestation verification.","impact":"Bot/automation attacks possible; rate limiting bypass more feasible; increased attack surface","affected_data":"All user data accessible via Cloud Functions"},"suggested_fix":{"steps":["Enable App Check in Firebase Console","Change requireAppCheck: false to requireAppCheck: true in all Cloud Functions","Test that functions reject requests without valid App Check tokens","Monitor for any legitimate traffic that might be blocked"],"code_example":"withSecurityChecks(request, { requireAppCheck: true, ... }, handler)","verification":["Verify App Check enforcement in function logs","Test with invalid App Check token"]},"owasp_category":"A05","cvss_estimate":"MEDIUM","evidence":["requireAppCheck: false, // TEMPORARILY DISABLED - waiting for throttle to clear"],"notes":"Code comments indicate this is temporary but has been disabled for an extended period","why_it_matters":"App Check temporarily disabled in all Cloud Functions","acceptance_tests":["Verify fix applied correctly"]}
{"category":"SecretsManagement","title":"Hardcoded reCAPTCHA site key fallback","fingerprint":"SecretsManagement::functions/src/recaptcha-verify.ts::hardcoded_key","severity":"S3","effort":"E0","confidence":100,"files":["functions/src/recaptcha-verify.ts"],"line":39,"vulnerability_details":{"description":"A fallback reCAPTCHA site key is hardcoded in the verification utility.","exploitation":"Could lead to misconfiguration if environment variable is not set; key could be forgotten in code","impact":"Configuration confusion; potential use of wrong reCAPTCHA key","affected_data":"None directly - reCAPTCHA site keys are public"},"suggested_fix":{"steps":["Remove the hardcoded fallback","Require RECAPTCHA_SITE_KEY environment variable","Set the environment variable in Cloud Functions config"],"code_example":"const siteKey = process.env.RECAPTCHA_SITE_KEY; if (!siteKey) throw new Error('RECAPTCHA_SITE_KEY required');","verification":["Deploy and verify functions work correctly","Check error handling when env var missing"]},"owasp_category":"N/A","cvss_estimate":"LOW","evidence":["const siteKey = process.env.RECAPTCHA_SITE_KEY || hardcoded-key"],"notes":"While reCAPTCHA site keys are public, hardcoding them is bad practice","why_it_matters":"Hardcoded reCAPTCHA site key fallback","acceptance_tests":["Verify fix applied correctly"]}
{"category":"Headers","title":"Content-Security-Policy header not configured","fingerprint":"Headers::firebase.json::csp_missing","severity":"S3","effort":"E1","confidence":100,"files":["firebase.json"],"line":1,"vulnerability_details":{"description":"The Content-Security-Policy (CSP) header is not configured in firebase.json.","exploitation":"XSS attacks could load external resources; no policy to restrict script/sources","impact":"Reduced XSS protection; attackers could load malicious resources","affected_data":"User session data, application data"},"suggested_fix":{"steps":["Add CSP header to firebase.json","Test all app functionality still works","Use securityheaders.com to verify"],"code_example":"Add CSP header with appropriate directives for Firebase services","verification":["Verify CSP header present in response headers","Test all functionality works"]},"owasp_category":"A05","cvss_estimate":"LOW","evidence":["firebase.json headers section missing Content-Security-Policy"],"notes":"CSP is a critical defense against XSS attacks","why_it_matters":"Content-Security-Policy header not configured","acceptance_tests":["Verify fix applied correctly"]}
{"category":"Headers","title":"Cross-Origin-Embedder-Policy not configured","fingerprint":"Headers::firebase.json::coep_missing","severity":"S3","effort":"E0","confidence":100,"files":["firebase.json"],"line":1,"vulnerability_details":{"description":"Cross-Origin-Embedder-Policy (COEP) header is not configured.","exploitation":"Certain cross-origin attacks may be possible without COEP","impact":"Reduced cross-origin attack protection","affected_data":"Minimal impact for this app architecture"},"suggested_fix":{"steps":["Add COEP header to firebase.json","May need CORP header for Firebase resources"],"code_example":"Add Cross-Origin-Embedder-Policy: require-corp header","verification":["Verify header present in response headers"]},"owasp_category":"A05","cvss_estimate":"LOW","evidence":["firebase.json headers section missing Cross-Origin-Embedder-Policy"],"notes":"Defense in depth - less critical for this app","why_it_matters":"Cross-Origin-Embedder-Policy not configured","acceptance_tests":["Verify fix applied correctly"]}