{"category":"ai-optimization","title":"session-start.js outputs 400-600 tokens of verbose status on every session start","fingerprint":"ai-optimization::.claude/hooks/session-start.js::verbose-hook-output-token-waste","severity":"S1","effort":"E2","confidence":90,"files":[".claude/hooks/session-start.js"],"why_it_matters":"SessionStart hook stdout is injected into Claude context on every session. The 30+ line output costs ~400-600 tokens per session before any user work begins.","suggested_fix":"Condense hook output to 5-8 lines: one status line per major step only, suppress decorative borders, remove footer text.","acceptance_tests":["Hook output is <=10 lines when all steps pass","Token count of hook output is <100 tokens per session","Warnings and errors still surface clearly"],"evidence":["session-start.js lines 43-505: 30+ console.log() calls","system-reminder tag confirms full hook stdout injected into context"]}
{"category":"ai-optimization","title":"SessionStart runs 4 sequential Node process spawns — 4-8s cold-start latency","fingerprint":"ai-optimization::.claude/settings.json::sequential-session-start-hooks","severity":"S1","effort":"E2","confidence":85,"files":[".claude/settings.json",".claude/hooks/session-start.js",".claude/hooks/check-mcp-servers.js",".claude/hooks/check-remote-session-context.js",".claude/hooks/stop-serena-dashboard.js"],"why_it_matters":"settings.json wires 4 sequential SessionStart hooks. Cold-start latency is 4-8 seconds before any user turn.","suggested_fix":"Merge check-mcp-servers.js and stop-serena-dashboard.js into session-start.js. Run check-remote-session-context.js asynchronously.","acceptance_tests":["SessionStart completes in <3 seconds on warm session","MCP server and remote branch checks still occur"],"evidence":["settings.json hooks.SessionStart: 4 separate command entries","check-remote-session-context.js: FETCH_TTL_MS = 5 * 60 * 1000"]}
{"category":"ai-optimization","title":"session-start.js spawns 2 unnecessary child processes for node/npm version strings","fingerprint":"ai-optimization::.claude/hooks/session-start.js::execsync-version-display-subprocess","severity":"S2","effort":"E0","confidence":95,"files":[".claude/hooks/session-start.js"],"why_it_matters":"Two execSync() calls for version strings with near-zero diagnostic value. process.version provides node version at zero cost.","suggested_fix":"Replace execSync('node -v') with process.version. Remove npm -v entirely.","acceptance_tests":["No execSync for version checks","Node version uses process.version"],"evidence":["session-start.js line 49: execSync('node -v')","session-start.js line 55: execSync('npm -v')"]}
{"category":"ai-optimization","title":"session-start.sh (365 lines) is dead code — replaced by session-start.js","fingerprint":"ai-optimization::.claude/hooks/session-start.sh::dead-replaced-hook-script","severity":"S2","effort":"E0","confidence":90,"files":[".claude/hooks/session-start.sh"],"why_it_matters":"session-start.js states it is the Cross-platform replacement. settings.json only wires session-start.js. The 365-line shell script is never invoked.","suggested_fix":"Delete session-start.sh.","acceptance_tests":["session-start.sh does not exist","settings.json has no reference to it"],"evidence":["settings.json only lists session-start.js","session-start.js line 7: Cross-platform replacement for session-start.sh"]}
{"category":"ai-optimization","title":"13 consolidated-out hook JS files remain as dead standalone executables","fingerprint":"ai-optimization::.claude/hooks::orphaned-pre-consolidation-hook-files","severity":"S2","effort":"E1","confidence":80,"files":[".claude/hooks/agent-trigger-enforcer.js",".claude/hooks/app-check-validator.js",".claude/hooks/audit-s0s1-validator.js",".claude/hooks/auto-save-context.js",".claude/hooks/check-requirements.js",".claude/hooks/compaction-handoff.js",".claude/hooks/component-size-check.js",".claude/hooks/firestore-write-block.js",".claude/hooks/large-context-warning.js",".claude/hooks/repository-pattern-check.js",".claude/hooks/test-mocking-validator.js",".claude/hooks/typescript-strict-check.js",".claude/hooks/pattern-check.js"],"why_it_matters":"post-write-validator.js replaced 10 hooks, post-read-handler.js replaced 3 more. Originals remain as ~2000 lines of dead code.","suggested_fix":"Move to .claude/hooks/archive/ or delete them.","acceptance_tests":["All 13 files deleted or archived","settings.json functions correctly"],"evidence":["post-write-validator.js: Replaces 10 separate hooks","post-read-handler.js: Replaces 3 separate hooks"]}
{"category":"ai-optimization","title":"session-start.js spawns separate Node process for pattern scan on every session start","fingerprint":"ai-optimization::.claude/hooks/session-start.js::execsync-pattern-check-subprocess","severity":"S2","effort":"E1","confidence":85,"files":[".claude/hooks/session-start.js",".claude/hooks/post-write-validator.js"],"why_it_matters":"execSync for check-pattern-compliance.js every session start (300-800ms). Same patterns already run inline in post-write-validator.js.","suggested_fix":"Gate behind file-hash cache or skip entirely since post-write-validator.js catches violations in real time.","acceptance_tests":["Pattern check skipped when source files unchanged","Cache file records last-checked hash"],"evidence":["session-start.js line 383-396: execSync with no hash-cache guard","Hash caching exists for npm install but NOT for pattern check"]}
{"category":"ai-optimization","title":"CRITICAL Persistence Rules boilerplate copy-pasted across 4+ audit SKILL.md files","fingerprint":"ai-optimization::.claude/skills::duplicated-persistence-rules-boilerplate","severity":"S2","effort":"E1","confidence":85,"files":[".claude/skills/audit-ai-optimization/SKILL.md",".claude/skills/audit-process/SKILL.md",".claude/skills/audit-enhancements/SKILL.md",".claude/skills/create-audit/SKILL.md"],"why_it_matters":"~50-line Persistence Rules block duplicated across 4+ files. Costs ~150 tokens per skill load.","suggested_fix":"Create _shared/AUDIT_PERSISTENCE_RULES.md as single canonical source.","acceptance_tests":["Block appears in only one location","Each audit SKILL.md references shared file"],"evidence":["audit-ai-optimization/SKILL.md lines 36-57: identical boilerplate","audit-process/SKILL.md lines 32-52: identical boilerplate"]}
{"category":"ai-optimization","title":"doc-optimizer and audit-process SKILL.md exceed 1500 lines without modularization","fingerprint":"ai-optimization::.claude/skills::oversized-skill-md-files","severity":"S2","effort":"E2","confidence":75,"files":[".claude/skills/doc-optimizer/SKILL.md",".claude/skills/audit-process/SKILL.md",".claude/skills/audit-documentation/SKILL.md",".claude/skills/multi-ai-audit/SKILL.md"],"why_it_matters":"doc-optimizer (1735 lines) and audit-process (1525 lines) loaded in full, adding 3000-5000 tokens.","suggested_fix":"Extract per-agent prompt templates to reference/ subdirectories.","acceptance_tests":["Both SKILL.md files <600 lines","Extracted content in reference/ subdirectories"],"evidence":["wc -l: doc-optimizer 1735, audit-process 1525, audit-documentation 1000, multi-ai-audit 948"]}
{"category":"ai-optimization","title":"stop-serena-dashboard.js runs every SessionStart despite Serena MCP being disabled","fingerprint":"ai-optimization::.claude/hooks/stop-serena-dashboard.js::unnecessary-session-start-hook","severity":"S2","effort":"E0","confidence":90,"files":[".claude/hooks/stop-serena-dashboard.js",".claude/settings.json"],"why_it_matters":"Serena is in disabledMcpjsonServers but stop-serena-dashboard.js still runs every session checking port 24282.","suggested_fix":"Add early-exit reading disabledMcpjsonServers or remove from SessionStart hooks.","acceptance_tests":["No port check when Serena disabled","Exits within <10ms when disabled"],"evidence":["settings.json: disabledMcpjsonServers includes serena","Session transcript: No process listening on port 24282"]}
{"category":"ai-optimization","title":"Agent sub-prompts omit evidence field from output schema","fingerprint":"ai-optimization::.claude/skills/audit-ai-optimization/SKILL.md::agent-prompt-missing-evidence-field","severity":"S2","effort":"E0","confidence":85,"files":[".claude/skills/audit-ai-optimization/SKILL.md"],"why_it_matters":"Audit instructions require evidence array but Task() agent schemas omit this field.","suggested_fix":"Add evidence field to every agent output schema.","acceptance_tests":["All agent schemas include evidence field","S0/S1 findings include at least 2 evidence items"],"evidence":["Agent 1A schema line 170-171: no evidence field","Agent 1B schema line 196-197: same omission"]}
{"category":"ai-optimization","title":"Task() sub-agents dont check FALSE_POSITIVES.jsonl before reporting","fingerprint":"ai-optimization::.claude/skills/audit-ai-optimization/SKILL.md::agent-prompts-missing-false-positive-exclusion","severity":"S2","effort":"E1","confidence":80,"files":[".claude/skills/audit-ai-optimization/SKILL.md",".claude/skills/audit-process/SKILL.md"],"why_it_matters":"Orchestrator reads FALSE_POSITIVES.jsonl but Task() agents start in fresh contexts without it. Known FPs re-reported every audit.","suggested_fix":"Add to each agent prompt: read FALSE_POSITIVES.jsonl and exclude matching entries.","acceptance_tests":["No findings matching FALSE_POSITIVES.jsonl","Agent prompts mention FALSE_POSITIVES.jsonl"],"evidence":["Orchestrator reads FALSE_POSITIVES not propagated to subagents","Agent 1A prompt has zero mention of FALSE_POSITIVES.jsonl"]}
{"category":"ai-optimization","title":"filesystem MCP server configured but permanently disabled — dead config","fingerprint":"ai-optimization::.mcp.json::dead-filesystem-mcp-server-config","severity":"S3","effort":"E0","confidence":90,"files":[".mcp.json",".claude/settings.json"],"why_it_matters":"filesystem entry self-annotated as disabled and in disabledMcpjsonServers. Dead config adds cognitive overhead.","suggested_fix":"Remove filesystem entry from .mcp.json entirely.","acceptance_tests":["filesystem not in .mcp.json","MCP config only lists active servers"],"evidence":[".mcp.json: filesystem with note stating disabled","settings.json: disabledMcpjsonServers includes filesystem"]}
{"category":"ai-optimization","title":"settings.json disabledMcpjsonServers has 3 stale entries not in .mcp.json","fingerprint":"ai-optimization::.claude/settings.json::stale-disabled-mcp-server-entries","severity":"S3","effort":"E0","confidence":85,"files":[".claude/settings.json",".mcp.json"],"why_it_matters":"disabledMcpjsonServers includes rube, serena, nextjs-devtools — none in .mcp.json. Stale entries with no documentation.","suggested_fix":"Remove stale entries or add comments explaining they target global configs.","acceptance_tests":["Each entry corresponds to known server or is documented"],"evidence":["settings.json: rube, serena, nextjs-devtools, filesystem",".mcp.json only has: filesystem, playwright, memory, sonarcloud"]}
{"category":"ai-optimization","title":"session-start.js reads full reviews.jsonl for a single count check","fingerprint":"ai-optimization::.claude/hooks/session-start.js::reviews-jsonl-full-read-rotation-check","severity":"S3","effort":"E0","confidence":80,"files":[".claude/hooks/session-start.js"],"why_it_matters":"Reads entire reviews.jsonl (19KB), splits, counts entries for rotation threshold. A sidecar count file would suffice.","suggested_fix":"Track count in reviews-meta.json sidecar file.","acceptance_tests":["Does not read full reviews.jsonl at startup","Rotation still triggers at 50-entry threshold"],"evidence":["session-start.js lines 427-452: reads full file for count only","reviews.jsonl: 19KB with 31 entries"]}
{"category":"ai-optimization","title":"health-score-log.jsonl and hook-warnings-log.jsonl grow unboundedly — no rotation","fingerprint":"ai-optimization::.claude/state::unbounded-jsonl-logs-no-rotation","severity":"S3","effort":"E1","confidence":80,"files":[".claude/state/health-score-log.jsonl",".claude/state/hook-warnings-log.jsonl"],"why_it_matters":"reviews.jsonl has rotation. health-score-log and hook-warnings-log have none. rotateJsonl() exists but only applied to reviews.jsonl.","suggested_fix":"Apply rotateJsonl() to both files in session-start.js.","acceptance_tests":["health-score-log never exceeds 30 entries","hook-warnings-log never exceeds 50 entries"],"evidence":["session-start.js: rotation NOT applied to other logs","health-score-log.jsonl: 8 entries growing","hook-warnings-log.jsonl: 16 entries growing"]}
