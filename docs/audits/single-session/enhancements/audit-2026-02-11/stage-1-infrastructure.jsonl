{"category":"infrastructure","title":"Enable Next.js experimental optimizations and bundle analysis","fingerprint":"nextjs-missing-bundle-config","impact":"I1","effort":"E0","confidence":85,"files":["next.config.mjs:12-19"],"current_approach":"Minimal next.config.mjs with only output:export and unoptimized images","proposed_outcome":"Add experimental.optimizePackageImports for heavy libraries (leaflet, recharts, framer-motion), enable bundle analyzer, configure modularizeImports for lucide-react","counter_argument":"Static export mode limits some Next.js optimizations; bundle analyzer adds dev dependency overhead; current build size may already be acceptable","why_it_matters":"Large map/chart libraries (leaflet, recharts) are imported but not tree-shaken optimally","evidence":"app/layout.tsx imports multiple heavy libraries, no dynamic imports detected, meeting-map.tsx imports entire leaflet"}
{"category":"infrastructure","title":"Add Content-Security-Policy header to Firebase hosting configuration","fingerprint":"firebase-missing-csp-header","impact":"I1","effort":"E1","confidence":75,"files":["firebase.json:6-57"],"current_approach":"Comprehensive security headers excluding CSP","proposed_outcome":"Add CSP header with directives for script-src, style-src, img-src, connect-src (Firebase domains + Google reCAPTCHA), frame-ancestors 'none'","counter_argument":"CSP can break functionality if misconfigured (reCAPTCHA, Firebase SDK, inline styles from Tailwind); requires extensive testing; existing headers provide strong baseline","why_it_matters":"CSP provides additional layer against XSS attacks; industry best practice for modern web apps","evidence":"firebase.json has X-Frame-Options, HSTS, X-Content-Type-Options but no CSP"}
{"category":"infrastructure","title":"Add engines field to root package.json for CI/CD consistency","fingerprint":"missing-node-engine-constraint","impact":"I1","effort":"E0","confidence":90,"files":["package.json:1-165","functions/package.json:13-15"],"current_approach":"Functions package.json specifies Node 20, root package.json has no engine constraint","proposed_outcome":"Add engines: {node: >=20.0.0} to root package.json matching functions runtime","counter_argument":"Lack of constraint hasn't caused issues; can be restrictive for contributors","why_it_matters":"Ensures consistent Node version across development, CI, and production","evidence":"functions/package.json:14 specifies node 20, root has no engines field"}
{"category":"infrastructure","title":"Firestore security rules file not found in repository","fingerprint":"missing-firestore-rules-file","impact":"I2","effort":"E0","confidence":70,"files":["firebase.json:72-74"],"current_approach":"firebase.json references firestore.rules but file not found in repo","proposed_outcome":"Ensure firestore.rules is tracked in repository, or confirm if managed via Firebase console","counter_argument":"Rules may be managed through Firebase console only; file might exist but search missed it","why_it_matters":"Security rules are critical infrastructure and should be version controlled for audit trail","evidence":"firebase.json:73 references firestore.rules, no .rules files found in glob search"}
{"category":"infrastructure","title":"Configure Next.js build cache and dependency caching for faster CI builds","fingerprint":"missing-ci-build-cache","impact":"I1","effort":"E1","confidence":80,"files":["next.config.mjs:12","package.json:6"],"current_approach":"No cache configuration for .next/cache or node_modules in CI","proposed_outcome":"Cache .next/cache, node_modules, and functions/lib directories; reduces build time 50-70%","counter_argument":"Cache invalidation can cause issues; storage costs; builds may already be fast enough","why_it_matters":"Faster feedback loops for PRs; reduced CI minutes consumption","evidence":"tsconfig.json:15 has incremental: true, no CI cache actions found"}
{"category":"infrastructure","title":"Lazy load Leaflet and Recharts with dynamic imports and Suspense","fingerprint":"heavy-libs-no-dynamic-import","impact":"I1","effort":"E2","confidence":75,"files":["components/maps/meeting-map.tsx:1-80"],"current_approach":"Direct synchronous imports of leaflet (500KB+) and recharts (400KB+)","proposed_outcome":"Use Next.js dynamic() with ssr: false for map components, React.lazy for charts","counter_argument":"Static export mode may limit code splitting benefits; components may be on initial page load; adds loading state complexity","why_it_matters":"Not all users visit map/chart pages; faster time-to-interactive for initial load","evidence":"meeting-map.tsx imports full leaflet synchronously, no dynamic imports for recharts"}
{"category":"infrastructure","title":"Upgrade Firebase Functions to Node.js 24 runtime","fingerprint":"functions-runtime-node20-upgrade","impact":"I0","effort":"E1","confidence":70,"files":["firebase.json:68","functions/package.json:14"],"current_approach":"Firebase Functions using Node.js 20 runtime","proposed_outcome":"Upgrade to nodejs24 runtime, update engines to node 24, test all functions","counter_argument":"Node 20 is still LTS until October 2026; no compelling features for this use case; risk of breaking changes","why_it_matters":"Longer LTS support window; aligns with bleeding-edge philosophy of the project","evidence":"firebase.json:68 shows nodejs24 available, functions uses node 20"}
{"category":"infrastructure","title":"Add composite index for userId + timestamp on security_logs collection","fingerprint":"security-logs-missing-user-timestamp-index","impact":"I1","effort":"E0","confidence":85,"files":["firestore.indexes.json:18-80"],"current_approach":"Indexes for severity+timestamp, type+functionName+timestamp, but no userId composite","proposed_outcome":"Add index for security_logs: [userId ASC, timestamp DESC] for efficient user-specific log queries","counter_argument":"Query may not exist yet; automatic indexing warnings will prompt when needed; adds storage overhead","why_it_matters":"Admin panel likely needs per-user security logs; composite index prevents full collection scans","evidence":"firestore.indexes.json has security_logs indexes but only severity/type/functionName composites"}
{"type":"strength","domain":"infrastructure","description":"Excellent security headers configuration in firebase.json - HSTS, X-Frame-Options, X-Content-Type-Options, Permissions-Policy, Referrer-Policy","evidence":["firebase.json implements comprehensive security headers","Only CSP is missing from a complete header set"]}
{"type":"strength","domain":"infrastructure","description":"Optimal Firebase configuration - Node.js 24 runtime available, proper rate limiting with Firestore persistence, comprehensive indexes","evidence":["firebase.json configured with latest runtimes","Firestore indexes cover all major query patterns"]}
{"type":"strength","domain":"infrastructure","description":"Strong TypeScript configuration - strict mode, incremental compilation, proper path aliases across all tsconfig files","evidence":["tsconfig.json with strict: true","incremental: true for faster builds","Path aliases configured"]}
{"type":"strength","domain":"infrastructure","description":"Modern build tooling - ESLint 9.x flat config, custom eslint-plugin-sonash, Prettier with sensible defaults","evidence":["eslint.config.mjs with flat config format","Custom sonash plugin for project-specific rules"]}
{"type":"strength","domain":"infrastructure","description":"Optimized font loading - self-hosted @fontsource (no Google Fonts CDN), only 2 essential fonts, font-display: swap","evidence":["@fontsource packages in dependencies","Reduced from 20+ to 2 fonts"]}
{"type":"strength","domain":"infrastructure","description":"Well-architected pre-commit hooks with smart doc-only commit detection to skip tests, comprehensive escape hatches","evidence":["pre-commit detects doc-only commits and skips test run","Environment variable overrides for each check"]}
