{"id":"SEC-001","category":"Headers","severity":"S1","effort":"E1","confidence":"HIGH","verified":"DUAL_PASS_CONFIRMED","owasp":["A05"],"file":"firebase.json","line":6,"title":"Missing critical security headers","description":"Missing security headers: Content-Security-Policy (CSP), X-Frame-Options, X-Content-Type-Options, Strict-Transport-Security (HSTS), Referrer-Policy, Permissions-Policy. Only Cache-Control and COOP are configured.","recommendation":"Add comprehensive security headers to firebase.json hosting configuration. This was also flagged in audit-2026-01-13 (SEC-002). Priority fix.","cwe":"CWE-693","evidence":["firebase.json only has Cache-Control and Cross-Origin-Opener-Policy headers","Prior audit SEC-002 documented same issue"],"cross_ref":"MANUAL_ONLY"}
{"id":"SEC-002","category":"Firebase","severity":"S1","effort":"E0","confidence":"HIGH","verified":"DUAL_PASS_CONFIRMED","owasp":["A01"],"file":"functions/src/index.ts","line":84,"title":"App Check disabled on Cloud Functions","description":"Firebase App Check is disabled (requireAppCheck: false) on all Cloud Functions. Comment says 'TEMPORARILY DISABLED - waiting for throttle to clear'. This removes bot protection layer.","recommendation":"Re-enable App Check once throttle period clears. This was flagged in audit-2026-01-13 (SEC-001). Check if throttle has cleared.","cwe":"CWE-862","evidence":["Prior audit SEC-001 documented same issue","requireAppCheck: false appears 5 times in index.ts"],"cross_ref":"MANUAL_ONLY"}
{"id":"SEC-003","category":"Crypto","severity":"S2","effort":"E0","confidence":"MEDIUM","verified":"MANUAL_ONLY","owasp":["A02"],"file":"functions/src/recaptcha-verify.ts","line":66,"title":"Hardcoded reCAPTCHA site key fallback","description":"Hardcoded reCAPTCHA site key as fallback: '6LdeazosAAAAAMDNCh1hTUDKh_UeS6xWY1-85B2O'. Makes key rotation difficult.","recommendation":"Remove hardcoded fallback. Fail early with clear error if RECAPTCHA_SITE_KEY env var is not set.","cwe":"CWE-798","evidence":["grep shows hardcoded key in recaptcha-verify.ts","Prior audit SEC-003 documented same issue"],"cross_ref":"MANUAL_ONLY"}
{"id":"SEC-004","category":"Auth","severity":"S3","effort":"E0","confidence":"HIGH","verified":"TOOL_VALIDATED","owasp":["A02"],"file":"lib/utils/errors.ts","line":69,"title":"SonarCloud: Potentially hard-coded password pattern","description":"SonarCloud flags error message strings containing 'password' as potential hardcoded credentials. These are user-facing error messages, not actual credentials.","recommendation":"This is a FALSE POSITIVE. The strings are Firebase error code descriptions (e.g., 'auth/wrong-password': 'Incorrect password'). No action needed.","cwe":"CWE-798","evidence":["SonarCloud hotspot AZuOceBbCkZo7bf_PZva","Code shows error message mapping, not credentials"],"cross_ref":"sonarcloud"}
{"id":"SEC-005","category":"Input","severity":"S2","effort":"E2","confidence":"MEDIUM","verified":"TOOL_VALIDATED","owasp":["A03"],"file":"scripts/ai-review.js","line":222,"title":"OS command execution in CLI scripts","description":"SonarCloud flags execSync/spawnSync in CLI scripts. These execute git commands with file paths that could contain special characters. Scripts are developer-only tools.","recommendation":"Validate and sanitize file paths before passing to shell commands. Use array-based spawn instead of shell string interpolation where possible.","cwe":"CWE-78","evidence":["SonarCloud hotspots for command-injection in scripts/ai-review.js, check-pattern-compliance.js, check-review-needed.js","10 HIGH probability hotspots for command injection"],"cross_ref":"sonarcloud"}
{"id":"SEC-006","category":"Input","severity":"S2","effort":"E2","confidence":"MEDIUM","verified":"TOOL_VALIDATED","owasp":["A03"],"file":"functions/src/admin.ts","line":143,"title":"ReDoS vulnerable regex patterns","description":"SonarCloud flags 33 regex patterns as vulnerable to ReDoS (super-linear runtime due to backtracking). Most are in CLI scripts but some are in production code (admin.ts, security-logger.ts, sentry.client.ts).","recommendation":"Review flagged regexes in production code. Use atomic groups or possessive quantifiers. For CLI scripts, input is bounded so risk is low.","cwe":"CWE-1333","evidence":["SonarCloud hotspots for dos/S5852 rule","33 MEDIUM probability hotspots across scripts and app code"],"cross_ref":"sonarcloud"}
{"id":"SEC-007","category":"Crypto","severity":"S3","effort":"E0","confidence":"HIGH","verified":"TOOL_VALIDATED","owasp":["A02"],"file":"components/celebrations/confetti-burst.tsx","line":39,"title":"Math.random for visual effects","description":"SonarCloud flags Math.random() usage in celebration components. These are for visual randomization (confetti colors, positions), not security purposes.","recommendation":"FALSE POSITIVE. Math.random is appropriate for visual effects. Document that these are non-security uses.","cwe":"CWE-330","evidence":["SonarCloud hotspots for weak-cryptography/S2245","10 occurrences in confetti-burst.tsx and firework-burst.tsx"],"cross_ref":"sonarcloud"}
{"id":"SEC-008","category":"Deps","severity":"S3","effort":"E0","confidence":"HIGH","verified":"TOOL_VALIDATED","owasp":["A06"],"file":".github/workflows/auto-label-review-tier.yml","line":29,"title":"GitHub Actions using version tags instead of SHA","description":"SonarCloud flags GitHub Actions using version tags (e.g., actions/checkout@v4) instead of full commit SHA hashes. Version tags can be moved to point to different commits.","recommendation":"Pin GitHub Actions to full commit SHA for supply chain security. Low risk as these are official GitHub actions.","cwe":"CWE-829","evidence":["SonarCloud hotspots for githubactions:S7637","2 workflows flagged"],"cross_ref":"sonarcloud"}
{"id":"SEC-009","category":"Data","severity":"S3","effort":"E0","confidence":"HIGH","verified":"TOOL_VALIDATED","owasp":["A05"],"file":".github/workflows/deploy-firebase.yml","line":58,"title":"Secrets expanded in run block","description":"SonarCloud flags secret expansion in GitHub Actions run block. The secret is written to a temporary file with chmod 600.","recommendation":"Current implementation is reasonable - file is temporary and permissions are restricted. Consider using action inputs instead of shell expansion for extra safety.","cwe":"CWE-200","evidence":["SonarCloud hotspot for githubactions:S7636","Secret written to temp file with restricted permissions"],"cross_ref":"sonarcloud"}
{"id":"SEC-010","category":"Framework","severity":"S3","effort":"E0","confidence":"HIGH","verified":"MANUAL_ONLY","owasp":["A07"],"file":"components/providers/error-boundary.tsx","line":84,"title":"process.env.NODE_ENV checks for debug info","description":"Components use process.env.NODE_ENV === 'development' to conditionally show debug info. This is correct Next.js pattern for dev-only features.","recommendation":"No action needed. This is the correct pattern for development-only debugging.","cwe":"CWE-200","evidence":["10 occurrences of process.env.NODE_ENV checks in components","All guard debug output, not secrets"],"cross_ref":"MANUAL_ONLY"}
{"id":"SEC-011","category":"AgentSecurity","severity":"S3","effort":"E0","confidence":"MEDIUM","verified":"MANUAL_ONLY","owasp":[],"file":".claude/settings.json","line":1,"title":"Agent config files present","description":".claude/ directory contains agent configurations, skills, and hooks. No obvious prompt injection patterns found in quick review.","recommendation":"Periodically review .claude/ configs for suspicious patterns. Current configs appear safe.","cwe":"","evidence":["19 files in .claude/ directory","settings.json, hooks/, skills/, commands/ all present"],"cross_ref":"MANUAL_ONLY"}
