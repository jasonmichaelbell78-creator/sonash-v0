{"id": "PERF-CI-001", "file": ".github/workflows/ci.yml", "issue": "Missing Next.js build cache in build job", "impact": "slow CI - build job recomputes from scratch every run (est. 60-90 seconds per build)", "severity": "S2", "recommendation": "Add 'actions/cache@v4' with key for .next directory. Cache key: 'nextjs-build-${{ hashFiles('**/package-lock.json') }}-${{ github.ref }}'. Restore keys: ['nextjs-build-', 'nextjs-']. Paths: '.next/cache'"}
{"id": "PERF-CI-002", "file": ".github/workflows/ci.yml", "issue": "npm install dependencies cached but not TypeScript compilation cache", "impact": "slow CI - tsc --noEmit recompiles all files (est. 30-45 seconds)", "severity": "S3", "recommendation": "Add cache for tsc output. Use actions/cache with key 'tsc-cache-${{ hashFiles('**/tsconfig.json', '**/package-lock.json') }}' and restore-keys pattern. Preserve tsconfig.tsbuildinfo if present."}
{"id": "PERF-CI-003", "file": ".github/workflows/ci.yml", "issue": "Test build and coverage recompile TypeScript each run - no artifact reuse between test:build and test:coverage", "impact": "wasted resources - tsc runs twice for test compilation (est. 30-45 seconds duplicated)", "severity": "S2", "recommendation": "Refactor test:build into separate 'Build Tests' step that caches dist-tests/ output. Share compiled artifacts between test and test:coverage steps. Use actions/cache or upload-artifact for dist-tests/."}
{"id": "PERF-CI-004", "file": ".github/workflows/ci.yml", "issue": "Build job depends on lint-typecheck-test (sequential), but could run in parallel on different runners", "impact": "slow CI - critical path extends by full lint time (est. 2-3 minutes added latency)", "severity": "S2", "recommendation": "Remove 'needs: lint-typecheck-test' from build job. Run both jobs in parallel. Add separate 'lint-gates' job that blocks on 'build' completion to ensure quality gates pass before merge."}
{"id": "PERF-CI-005", "file": ".github/workflows/ci.yml", "issue": "Coverage artifact retention set to 14 days (default), but never used in CI", "impact": "wasted resources - coverage artifacts consume storage for 2 weeks without value", "severity": "S3", "recommendation": "Reduce retention-days to 1 (or set on-demand). Or integrate into SonarCloud upload step to automatically delete local after upload. Consider generating HTML reports and uploading to GitHub Pages instead."}
{"id": "PERF-CI-006", "file": ".github/workflows/ci.yml", "issue": "Pattern compliance check runs changed-files action, but requires full git checkout - no shallow clone", "impact": "slow CI - unnecessary bandwidth for full history (est. 10-15 seconds saved)", "severity": "S3", "recommendation": "Add 'fetch-depth: 0' only for 'push to main' case. For PR, use shallow clone (fetch-depth: 1) and get changed-files from github.event.pull_request context instead of git diff."}
{"id": "PERF-CI-007", "file": ".github/workflows/deploy-firebase.yml", "issue": "Next.js build lacks persistent .next cache - rebuilds on every deployment", "impact": "slow CI - deployment adds 60-90 seconds for redundant build (est. 5-7 minutes per deploy)", "severity": "S2", "recommendation": "Add actions/cache@v4 for .next/ before 'Build Next.js app' step. Use same cache key strategy as ci.yml build job. Also enable incremental builds with 'NEXT_INCREMENTAL_BUILD=1' env var."}
{"id": "PERF-CI-008", "file": ".github/workflows/deploy-firebase.yml", "issue": "Functions build recompiles TypeScript from scratch - no tsc cache", "impact": "slow CI - functions tsc compilation (est. 15-25 seconds per deploy)", "severity": "S3", "recommendation": "Add cache for functions/lib/ (compiled output). Cache key: 'tsc-functions-${{ hashFiles('functions/tsconfig.json', 'functions/package-lock.json') }}'. Also add '--incremental' flag to functions/tsconfig.json."}
{"id": "PERF-CI-009", "file": ".github/workflows/deploy-firebase.yml", "issue": "Two separate package-lock.json caches (root + functions/) but resolved after root install completes", "impact": "wasted resources - sequential npm ci (can parallelize)", "severity": "S2", "recommendation": "Install root and functions dependencies in parallel using 'npm install' in background job or split into separate jobs with '&'. Or use monorepo tool (npm workspaces) to install both with single 'npm ci' pass."}
{"id": "PERF-CI-010", "file": ".github/workflows/docs-lint.yml", "issue": "No early exit for files with no markdown changes - still runs changed-files action", "impact": "slow CI - unnecessary git operations (est. 5-10 seconds)", "severity": "S3", "recommendation": "Add early 'Check if markdown files changed' step that exits with 0 immediately if no *.md files changed. Use 'if: steps.check.outputs.has_md_changes != 'true'' for later steps."}
{"id": "PERF-CI-011", "file": ".github/workflows/review-check.yml", "issue": "Full npm ci required just for Node.js environment to run single script - no caching for this workflow", "impact": "wasted resources - installing all deps (120+ packages) takes est. 30-40 seconds for lightweight script", "severity": "S2", "recommendation": "Add 'cache: npm' to setup-node step. Consider splitting scripts to run without full node_modules (use tsx/node directly on single file). Or cache node_modules explicitly with actions/cache."}
{"id": "PERF-CI-012", "file": ".github/workflows/auto-label-review-tier.yml", "issue": "No cache: npm in setup-node, requires full npm ci even though script is lightweight", "impact": "wasted resources - node_modules install takes est. 30-40 seconds for simple file pattern matching", "severity": "S2", "recommendation": "Add 'cache: npm' to setup-node step. Script could run without deps - consider reducing scope or using shell-native tools."}
{"id": "PERF-CI-013", "file": ".github/workflows/sonarcloud.yml", "issue": "No fail-fast or timeout for SonarCloud analysis - can hang or run indefinitely if token fails", "impact": "slow CI - SonarCloud can block PR for hours if service is slow (est. 15-30 min typical)", "severity": "S2", "recommendation": "Add 'timeout-minutes: 30' to job. Add explicit error handling and retry logic. Set SONARCLOUD_TIMEOUT env var if supported. Consider skipping for non-main branches in fork PRs (already done but no timeout)."}
{"id": "PERF-CI-014", "file": ".github/workflows/backlog-enforcement.yml", "issue": "Backlog check job runs without npm cache even though it uses npm ci and node script", "impact": "wasted resources - est. 30-40 seconds per backlog check for install + script", "severity": "S2", "recommendation": "Add 'cache: npm' to setup-node step. Security patterns job also missing cache. Both workflows should use '--prefer-offline --no-audit --no-fund' flags (already in backlog job) but need cache enabled."}
