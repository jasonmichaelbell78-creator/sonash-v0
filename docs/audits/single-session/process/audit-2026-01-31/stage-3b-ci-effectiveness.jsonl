{"severity":"S0","category":"Critical Gap","finding":"Backlog enforcement workflow checks non-existent file","description":"backlog-enforcement.yml checks AUDIT_FINDINGS_BACKLOG.md which was archived 2026-01-31 in TDMS Phase 2. The workflow gracefully exits with code 0 when file is missing, meaning backlog enforcement is COMPLETELY BYPASSED in CI.","impact":"Zero backlog health enforcement. S0/S1 debt items can accumulate indefinitely without CI blocking PRs.","file":".github/workflows/backlog-enforcement.yml","line":"35-43","evidence":"Lines 35-43: if [ ! -f \"docs/AUDIT_FINDINGS_BACKLOG.md\" ]; then echo \"total=0\" >> $GITHUB_OUTPUT; exit 0; fi","remediation":"Update workflow to check docs/technical-debt/MASTER_DEBT.jsonl instead. Use scripts/debt/validate-schema.js for enforcement.","verification_steps":["Create PR with S0 item in MASTER_DEBT.jsonl","Verify backlog-enforcement workflow blocks the PR","Verify threshold enforcement (25 item limit) works"],"canon_id":"CI-001"}
{"severity":"S1","category":"Continue-on-error Abuse","finding":"CI allows pattern compliance failures on main branch","description":"ci.yml line 75 uses continue-on-error: true for pattern compliance check on push to main. This means pattern violations can be merged to main without blocking.","impact":"Pattern violations accumulate in main branch. Anti-patterns documented in CODE_PATTERNS.md (230+ patterns) are not enforced post-merge.","file":".github/workflows/ci.yml","line":"71-76","evidence":"Lines 71-76: Pattern compliance check (push to main) ... continue-on-error: true ... run: npm run patterns:check-all","remediation":"Remove continue-on-error OR document explicit exceptions in CLAUDE.md. Pattern violations should block main branch.","verification_steps":["Introduce pattern violation in file","Push to main branch directly","Verify CI fails (not just warns)"],"canon_id":"CI-002"}
{"severity":"S1","category":"Continue-on-error Abuse","finding":"Documentation check is non-blocking in CI","description":"ci.yml line 78-81 runs npm run docs:check with continue-on-error: true. Comment says 'templates/stubs have expected issues', but this allows ANY doc issue to slip through.","impact":"Broken cross-references, missing required sections, stale dates can merge without detection.","file":".github/workflows/ci.yml","line":"78-81","evidence":"Lines 78-81: Documentation check ... continue-on-error: true ... run: npm run docs:check","remediation":"Split docs:check into --strict (block on active docs) and --lenient (warn on templates). Only use continue-on-error for templates.","verification_steps":["Break cross-reference in active doc (e.g., ROADMAP.md)","Create PR","Verify CI fails (not just warns)"],"canon_id":"CI-003"}
{"severity":"S1","category":"Continue-on-error Abuse","finding":"Audit validation non-blocking in CI","description":"ci.yml line 90 runs audit:validate with continue-on-error: true. Pre-commit hook (line 193-224) BLOCKS on S0/S1 violations, but CI does not.","impact":"Developers can bypass pre-commit with SKIP_AUDIT_VALIDATION=1 and merge broken audit files.","file":".github/workflows/ci.yml","line":"87-91","evidence":"Lines 87-91: Validate audit files ... continue-on-error: true ... run: npm run audit:validate -- --all","remediation":"Remove continue-on-error for audit validation. If template files need exemption, use --exclude-templates flag.","verification_steps":["Create audit JSONL with S0 item missing verification_steps","Set SKIP_AUDIT_VALIDATION=1 in pre-commit","Push to PR","Verify CI blocks (not pre-commit bypass)"],"canon_id":"CI-004"}
{"severity":"S1","category":"Validation Gap","finding":"Pre-commit runs pattern check on changed files only, CI runs on all files","description":"Pre-commit hook (line 33-42) runs npm run patterns:check (default file list). CI runs patterns:check on PR changed files (line 59-65) BUT patterns:check-all on main push. This creates inconsistency - developers test subset locally, CI checks everything post-merge.","impact":"Developers get false confidence from local pre-commit pass. Pattern violations in unchanged files only caught post-merge.","file":".husky/pre-commit","line":"33-42","evidence":"Pre-commit line 33-42 runs 'npm run patterns:check' (14 critical files per .husky/pre-commit). CI line 59-65 checks changed files only on PR.","remediation":"Align pre-commit and CI: both check changed files on PR, full check only on scheduled weekly run.","verification_steps":["Introduce pattern violation in non-critical file","Run pre-commit (should pass)","Create PR (CI should catch violation)"],"canon_id":"CI-005"}
{"severity":"S1","category":"Race Condition","finding":"No concurrency control on most workflows","description":"Only sync-readme.yml has concurrency control (line 6-8). Other workflows (ci.yml, backlog-enforcement.yml, docs-lint.yml, review-check.yml) can run concurrently on rapid pushes, creating race conditions in PR comments/labels.","impact":"Duplicate PR comments, label thrashing, wasted CI minutes. review-check.yml and docs-lint.yml both upsert comments - concurrent runs can create duplicates.","file":".github/workflows/*.yml","line":"N/A","evidence":"sync-readme.yml has 'concurrency: group: sync-readme-main' but ci.yml, backlog-enforcement.yml, docs-lint.yml lack concurrency groups.","remediation":"Add concurrency groups to all PR workflows: concurrency: { group: 'ci-${{ github.head_ref }}', cancel-in-progress: true }","verification_steps":["Push 2 commits rapidly to PR","Check Actions tab for concurrent runs","Verify only latest run executes after fix"],"canon_id":"CI-006"}
{"severity":"S2","category":"Testing Gap","finding":"Tests fail but CI passed on recent commit","description":"npm test shows 1 failing test (phase-complete-check.test.js) but recent commit e5bde5b merged successfully. Either tests are flaky or continue-on-error is hiding failures.","impact":"Broken functionality can merge if tests are flaky or CI doesn't enforce test failures.","file":".github/workflows/ci.yml","line":"115-125","evidence":"Local test run shows: 'ℹ pass 280 ℹ fail 1' but commit e5bde5b 'fix: address Qodo review suggestions (batch 5) + audit logging' merged to main.","remediation":"Investigate test flakiness. Add test retry logic (max 2 retries) OR mark flaky tests as skipped with JIRA ticket.","verification_steps":["Run npm test 3 times locally","Document which tests fail inconsistently","Add retry logic to CI workflow"],"canon_id":"CI-007"}
{"severity":"S2","category":"Continue-on-error Abuse","finding":"Technical debt validation non-blocking in CI","description":"ci.yml lines 98-111 check ROADMAP debt references and view staleness with continue-on-error: true. Pre-commit (line 242-259) BLOCKS on schema issues but not view staleness.","impact":"MASTER_DEBT.jsonl and generated views can drift. Developers can merge with stale views, breaking TDMS Phase 8 guarantees.","file":".github/workflows/ci.yml","line":"98-111","evidence":"Lines 98-111: Check ROADMAP debt references ... continue-on-error: true ... Verify technical debt views current ... continue-on-error: true","remediation":"Make view staleness check blocking. Add npm script: 'debt:check-views' that fails if git diff detects changes after regeneration.","verification_steps":["Modify MASTER_DEBT.jsonl without regenerating views","Create PR","Verify CI fails (not just warns)"],"canon_id":"CI-008"}
{"severity":"S2","category":"Validation Gap","finding":"Pre-commit skips tests for doc-only commits, CI always runs tests","description":"Pre-commit (line 67-89) skips tests if all staged files match doc patterns (*.md, *.jsonl, docs/, .claude/). CI (line 115-125) always runs full test suite. This creates inconsistency.","impact":"Developers expect fast doc-only commits locally but CI takes 20+ seconds running tests. Also creates potential bypass - commit JSON config as .jsonl to skip tests.","file":".husky/pre-commit","line":"67-89","evidence":"Lines 71-74: if [ -z \"$NON_DOC_FILES\" ]; then DOC_ONLY_COMMIT=1; echo \"⏭️ Skipping tests (doc-only commit)\"; fi","remediation":"Align pre-commit and CI: if PR only changes docs/*, skip tests in CI too. Use paths filter in ci.yml.","verification_steps":["Create doc-only PR (only *.md changes)","Verify CI skips test job","Modify .jsonl file, verify tests still run"],"canon_id":"CI-009"}
{"severity":"S2","category":"Validation Gap","finding":"docs-lint.yml only checks markdown files, misses broken refs in code comments","description":"docs-lint.yml (line 37-42) only checks **.md files. Code comments in TS/JS files often link to docs (e.g., 'See ARCHITECTURE.md#schema') but these aren't validated.","impact":"Code comments can have broken doc links. Developers follow stale references, wasting time.","file":".github/workflows/docs-lint.yml","line":"37-42","evidence":"Lines 37-42: files: | **/*.md | docs/**/*.md (no .ts, .tsx, .js files)","remediation":"Extend docs-lint to check code comments. Use AST parser to extract JSDoc/TSDoc links and validate them.","verification_steps":["Add broken doc link in JSDoc comment (e.g., @see MISSING.md)","Create PR","Verify CI warns about broken link"],"canon_id":"CI-010"}
{"severity":"S2","category":"Validation Gap","finding":"Pre-push checks security patterns but pre-commit does not","description":"Pre-push hook (line 37-79) runs security-check.js on changed files. Pre-commit hook does NOT run security checks. This means developers can commit insecure code locally, only blocked at push.","impact":"Insecure code sits in local commits. If developer force-pushes or bypasses pre-push, security issues merge.","file":".husky/pre-commit","line":"N/A","evidence":"Pre-commit runs: ESLint (line 7-16), patterns:check (line 33-42), but NO security:check. Pre-push runs security:check (line 37-79).","remediation":"Move security:check to pre-commit (fast - only checks changed files). Keep blocking in pre-push as backup.","verification_steps":["Add execSync with template literal (SEC-001 violation)","Run git commit (should block)","Verify pre-commit catches security issue"],"canon_id":"CI-011"}
{"severity":"S2","category":"Missing Validation","finding":"No CI check for DOCUMENTATION_INDEX.md staleness","description":"Pre-commit (line 133-153) blocks if .md files change but DOCUMENTATION_INDEX.md not updated. CI has no equivalent check.","impact":"Developers can bypass pre-commit with SKIP_DOC_INDEX_CHECK=1 and merge with stale index.","file":".github/workflows/ci.yml","line":"N/A","evidence":"Pre-commit line 133-153 blocks on stale index. No equivalent in ci.yml.","remediation":"Add step to ci.yml: 'Check doc index staleness' - regenerate index, check git diff, fail if different.","verification_steps":["Add new .md file, skip doc index update","Set SKIP_DOC_INDEX_CHECK=1 in pre-commit","Create PR","Verify CI blocks (not pre-commit bypass)"],"canon_id":"CI-012"}
{"severity":"S2","category":"Unclear Enforcement","finding":"review-check.yml is continue-on-error but doesn't actually enforce anything","description":"review-check.yml (line 31-34) runs check-review-needed.js with continue-on-error: true. The workflow only comments/labels, never blocks. This is informational only, not enforcement.","impact":"Misleading workflow name 'Review Trigger Check' implies enforcement. Developers ignore warnings, merge without human review on Tier 3/4 changes.","file":".github/workflows/review-check.yml","line":"31-34","evidence":"Lines 31-34: Run review trigger check ... continue-on-error: true (never fails workflow, only comments)","remediation":"Rename to 'review-recommendation.yml' OR make blocking for Tier 4 changes (firebase.json, workflows, package.json).","verification_steps":["Modify firebase.json (Tier 4 change)","Create PR","Verify workflow either blocks OR clearly labeled as recommendation"],"canon_id":"CI-013"}
{"severity":"S2","category":"Job Dependency Gap","finding":"Build job depends on lint-typecheck-test but not on other validation jobs","description":"ci.yml line 137 shows 'build' job needs: lint-typecheck-test. But backlog-health and security-patterns jobs (in backlog-enforcement.yml) are independent. Build can succeed while backlog/security jobs fail.","impact":"PR shows green checkmark from 'build' success even if backlog/security jobs failed. Misleading status.","file":".github/workflows/ci.yml","line":"134-137","evidence":"Lines 134-137: build: ... needs: lint-typecheck-test (no dependency on backlog-enforcement.yml jobs)","remediation":"Use required status checks in branch protection rules. Require ALL jobs (ci.yml, backlog-enforcement.yml, docs-lint.yml) to pass.","verification_steps":["Check branch protection rules on main","Verify backlog-health is required status check","Create PR that fails backlog check, verify merge blocked"],"canon_id":"CI-014"}
{"severity":"S3","category":"Optimization","finding":"CI runs npm ci twice (lint job + build job)","description":"ci.yml line 25 runs npm ci, then build job (line 150) runs npm ci again. Dependencies are cached but still takes 10-15s per job.","impact":"Wasted CI time. ~20-30s per PR that could be saved by sharing node_modules artifact.","file":".github/workflows/ci.yml","line":"25, 150","evidence":"Lines 25 and 150 both run 'npm ci' independently.","remediation":"Upload node_modules as artifact in lint job, download in build job. OR use Docker layer caching.","verification_steps":["Check CI run time before/after optimization","Verify build job still has correct dependencies"],"canon_id":"CI-015"}
{"severity":"S3","category":"Maintenance","finding":"validate-plan.yml only triggers on specific file path, likely stale","description":"validate-plan.yml (line 6-7) only triggers on changes to docs/archive/completed-plans/INTEGRATED_IMPROVEMENT_PLAN.md. This file is archived - workflow is likely dead code.","impact":"Dead workflow wastes maintenance effort. Confuses contributors about which validations run.","file":".github/workflows/validate-plan.yml","line":"6-7","evidence":"Lines 6-7: paths: - 'docs/archive/completed-plans/INTEGRATED_IMPROVEMENT_PLAN.md' (archived file, never changes)","remediation":"Delete validate-plan.yml OR update to check active planning docs (SESSION_CONTEXT.md, ROADMAP.md).","verification_steps":["Check git history - when was validate-plan.yml last triggered","Archive or update workflow"],"canon_id":"CI-016"}
