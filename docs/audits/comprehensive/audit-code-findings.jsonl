{"category":"code-quality","title":"Explicit any type in production callback","fingerprint":"code-quality::components/notebook/pages/today-page.tsx::CODE-001","severity":"S1","effort":"E0","confidence":90,"files":["components/notebook/pages/today-page.tsx:507"],"why_it_matters":"The handleSnapshotUpdate callback uses 'any' type for docSnap parameter, bypassing TypeScript safety in critical Firestore data handling code.","suggested_fix":"Replace 'any' with proper Firestore DocumentSnapshot type: import { DocumentSnapshot } from 'firebase/firestore'; const handleSnapshotUpdate = useCallback((docSnap: DocumentSnapshot, isMounted: boolean) => { ... }","acceptance_tests":["Run npm run lint - will show @typescript-eslint/no-explicit-any violation","Grep for ': any' in today-page.tsx","Review TypeScript strict mode settings in tsconfig.json"],"evidence":["const handleSnapshotUpdate = useCallback((docSnap: any, isMounted: boolean) => {","Grep pattern: :\\s*any\\b matched at line 507","TypeScript strict mode enabled in tsconfig.json"],"verification_steps":{"first_pass":{"method":"code_search","evidence_collected":["Run npm run lint - will show @typescript-eslint/no-explicit-any violation"]},"second_pass":{"method":"contextual_review","confirmed":true,"notes":"Review TypeScript strict mode settings in tsconfig.json"},"tool_confirmation":{"tool":"eslint","reference":"Run npm run lint - will show @typescript-eslint/no-explicit-any violation"}}}
{"category":"code-quality","title":"Multiple any types in test mock setup","fingerprint":"code-quality::tests/firestore-service.test.ts::CODE-002","severity":"S1","effort":"E1","confidence":90,"files":["tests/firestore-service.test.ts:18"],"why_it_matters":"Test file has 10+ instances of 'any' type in mock setup (lines 18-21, 25, 33, 39-40), reducing test reliability. Mock objects should have explicit interfaces matching Firestore SDK types.","suggested_fix":"Create typed mock interfaces: interface MockDocumentSnapshot { exists: () => boolean; data: () => Record<string, unknown>; } let getDocReturn: MockDocumentSnapshot;","acceptance_tests":["Check file-level ESLint disable comment at line 1","Count 'any' occurrences in test files","Compare against Firestore SDK type definitions"],"evidence":["/* eslint-disable @typescript-eslint/no-explicit-any */ at line 1","let setDocCalls: any[][];","let validateCalls: any[][];","assertUserScope: (_: any) => { ... }"],"verification_steps":{"first_pass":{"method":"code_search","evidence_collected":["Check file-level ESLint disable comment at line 1"]},"second_pass":{"method":"manual_verification","confirmed":true,"notes":"Confirmed via dual-pass review"},"tool_confirmation":{"tool":"NONE","reference":"Manual verification only"}}}
{"category":"code-quality","title":"Excessive debug logging block in production code","fingerprint":"code-quality::components/notebook/pages/today-page.tsx::CODE-003","severity":"S2","effort":"E1","confidence":90,"files":["components/notebook/pages/today-page.tsx:727"],"why_it_matters":"80-line debug logging block (lines 727-807) with 10+ console.log statements, even though properly guarded with NODE_ENV check. Should be extracted to separate debug utility.","suggested_fix":"Extract to separate debug utility: // lib/debug/weekly-stats-debug.ts export function debugWeeklyStatsQuery(data: WeeklyStatsDebug) { if (process.env.NODE_ENV !== 'development') return; console.log('ðŸ“Š Weekly Stats Debug:', data); }","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["if (process.env.NODE_ENV === 'development') { console.log('ðŸ“Š Weekly Stats Debug:', ...","console.log('ðŸ“Š Query returned:', snapshot.size, 'documents');","console.log('ðŸ“Š ALL logs in database:', allLogsSnapshot.size, 'total documents');","8 more console.log statements in same block"]}
{"category":"code-quality","title":"Commented code left in production","fingerprint":"code-quality::scripts/seed-meetings.ts::CODE-004","severity":"S2","effort":"E0","confidence":70,"files":["scripts/seed-meetings.ts:93"],"why_it_matters":"Commented-out warning suggests unresolved geocoding issue: // console.warn(`Missing coordinates for: ${cacheKey}`). Dead code should be removed or TODOs added.","suggested_fix":"Either uncomment to surface the issue or remove entirely if intentionally suppressed. If intentional, add comment explaining why.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// console.warn(`Missing coordinates for: ${cacheKey}`)","Grep found commented console statements"]}
{"category":"code-quality","title":"ESLint disable without justification","fingerprint":"code-quality::hooks/use-geolocation.ts::CODE-005","severity":"S2","effort":"E0","confidence":70,"files":["hooks/use-geolocation.ts:171"],"why_it_matters":"eslint-disable-line react-hooks/exhaustive-deps at line 171 lacks explanation comment. Need to verify this is intentional and document why.","suggested_fix":"Add justification comment: }, []); // eslint-disable-line react-hooks/exhaustive-deps - Empty deps intentional: only run on mount","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["}, []); // eslint-disable-line react-hooks/exhaustive-deps","No explanation comment provided"]}
{"category":"code-quality","title":"ESLint disable without justification","fingerprint":"code-quality::app/admin/page.tsx::CODE-006","severity":"S2","effort":"E0","confidence":70,"files":["app/admin/page.tsx:48"],"why_it_matters":"eslint-disable-next-line react-hooks/set-state-in-effect at line 48 lacks explanation. This is a React anti-pattern that should be justified.","suggested_fix":"Add justification comment or refactor to avoid setState in useEffect. Example: // eslint-disable-next-line react-hooks/set-state-in-effect -- Intentional: reset state when dependency changes","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// eslint-disable-next-line react-hooks/set-state-in-effect","Pattern found via grep"]}
{"category":"code-quality","title":"any type in test setup","fingerprint":"code-quality::tests/auth-provider.test.ts::CODE-007","severity":"S2","effort":"E0","confidence":90,"files":["tests/auth-provider.test.ts:25"],"why_it_matters":"let todayLog: any; at line 25 - test variables should have explicit types for better test reliability.","suggested_fix":"Replace with specific type: let todayLog: DailyLog | null;","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["let todayLog: any;","File has eslint-disable for @typescript-eslint/no-explicit-any at line 1"]}
{"category":"code-quality","title":"No test coverage for complex component","fingerprint":"code-quality::components/notebook/pages/today-page.tsx::CODE-008","severity":"S2","effort":"E2","confidence":70,"files":["components/notebook/pages/today-page.tsx:1"],"why_it_matters":"today-page.tsx is 940+ lines with complex autosave, sync, and state management logic but has no corresponding test file. Critical user-facing component should have integration tests.","suggested_fix":"Create tests/components/notebook/pages/today-page.test.ts covering: autosave logic, Firestore sync, mood/cravings/used state management, weekly stats calculation.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["File length: 940+ lines","Complex state management with multiple useEffect hooks","No corresponding test file found in tests/ directory"]}
{"category":"code-quality","title":"Long component file (940+ lines)","fingerprint":"code-quality::components/notebook/pages/today-page.tsx::CODE-009","severity":"S3","effort":"E0","confidence":90,"files":["components/notebook/pages/today-page.tsx:1"],"why_it_matters":"today-page.tsx is 940+ lines, exceeding recommended component size (300-500 lines). Consider extracting sub-components.","suggested_fix":"Extract sub-components: WeeklyStatsDisplay, JournalEntryForm, MoodSelector, AutosaveIndicator. Move business logic to custom hooks.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["File length: 940+ lines","Multiple responsibilities: journal entry, mood tracking, stats display, autosave"]}
{"category":"code-quality","title":"Long component file (400+ lines)","fingerprint":"code-quality::components/admin/admin-crud-table.tsx::CODE-010","severity":"S3","effort":"E0","confidence":90,"files":["components/admin/admin-crud-table.tsx:1"],"why_it_matters":"admin-crud-table.tsx is 400+ lines. While not critical, consider extracting sub-components for better maintainability.","suggested_fix":"Extract sub-components: TableFilters, TableRow, EditModal, DeleteConfirmation.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["File length: 400+ lines","Multiple responsibilities: filtering, CRUD operations, modal management"]}
{"category":"code-quality","title":"TODO marker for user customization","fingerprint":"code-quality::components/notebook/features/quick-actions-fab.tsx::CODE-011","severity":"S3","effort":"E1","confidence":90,"files":["components/notebook/features/quick-actions-fab.tsx:12"],"why_it_matters":"TODO: Make action buttons customizable by user (save preferences to profile/localStorage) - feature request left as TODO comment.","suggested_fix":"Either implement user customization feature or move to ROADMAP.md if low priority. Remove TODO comment from code.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// TODO: Make action buttons customizable by user (save preferences to profile/localStorage)"]}
{"category":"code-quality","title":"TODO marker for limit configuration","fingerprint":"code-quality::lib/database/firestore-adapter.ts::CODE-012","severity":"S3","effort":"E1","confidence":90,"files":["lib/database/firestore-adapter.ts:51"],"why_it_matters":"TODO: Pass limit to FirestoreService when it supports configurable limits - implementation task left as TODO comment.","suggested_fix":"Either implement configurable limits or move to ROADMAP.md. Remove TODO comment from code.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// TODO: Pass limit to FirestoreService when it supports configurable limits"]}
{"category":"code-quality","title":"ESLint disable for control-regex","fingerprint":"code-quality::lib/logger.ts::CODE-013","severity":"S3","effort":"E0","confidence":70,"files":["lib/logger.ts:86"],"why_it_matters":"eslint-disable-next-line no-control-regex at line 86 - verify this is necessary for ANSI code stripping.","suggested_fix":"Add comment explaining why control regex is needed: // eslint-disable-next-line no-control-regex - Intentional: strip ANSI escape codes from terminal output","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// eslint-disable-next-line no-control-regex","Pattern used for stripping ANSI codes"]}
{"category":"code-quality","title":"ESLint disable with partial justification","fingerprint":"code-quality::components/admin/users-tab.tsx::CODE-014","severity":"S3","effort":"E0","confidence":70,"files":["components/admin/users-tab.tsx:302"],"why_it_matters":"eslint-disable-next-line react-hooks/set-state-in-effect -- Intentional reset when user changes - good justification but should verify this is the best pattern.","suggested_fix":"Verify this is the cleanest way to reset state on user change. Consider using key prop or separate effect with proper dependencies.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// eslint-disable-next-line react-hooks/set-state-in-effect -- Intentional reset when user changes"]}
{"category":"code-quality","title":"ESLint disable without justification","fingerprint":"code-quality::components/admin/users-tab.tsx::CODE-015","severity":"S3","effort":"E0","confidence":70,"files":["components/admin/users-tab.tsx:354"],"why_it_matters":"eslint-disable-next-line react-hooks/exhaustive-deps at line 354 lacks explanation comment.","suggested_fix":"Add justification comment explaining why exhaustive deps check is disabled.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// eslint-disable-next-line react-hooks/exhaustive-deps","No explanation comment provided"]}
{"category":"code-quality","title":"Test file disables type checking","fingerprint":"code-quality::tests/firestore-service.test.ts::CODE-016","severity":"S3","effort":"E0","confidence":90,"files":["tests/firestore-service.test.ts:1"],"why_it_matters":"File-level eslint-disable @typescript-eslint/no-explicit-any at line 1 disables type checking for entire test file, reducing test quality.","suggested_fix":"Remove file-level disable and add explicit types to mock interfaces. Only disable linting on specific lines where necessary with justification.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["/* eslint-disable @typescript-eslint/no-explicit-any */","Entire file bypasses type safety"]}
{"category":"code-quality","title":"Test file disables type checking","fingerprint":"code-quality::tests/auth-provider.test.ts::CODE-017","severity":"S3","effort":"E0","confidence":90,"files":["tests/auth-provider.test.ts:1"],"why_it_matters":"File-level eslint-disable @typescript-eslint/no-explicit-any at line 1 disables type checking for entire test file.","suggested_fix":"Remove file-level disable and add explicit types. Use proper Firebase Auth types for mocks.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["/* eslint-disable @typescript-eslint/no-explicit-any */"]}
{"category":"code-quality","title":"ESLint disable in test for type bypass","fingerprint":"code-quality::tests/scripts/validate-audit-s0s1.test.ts::CODE-018","severity":"S3","effort":"E0","confidence":70,"files":["tests/scripts/validate-audit-s0s1.test.ts:254"],"why_it_matters":"eslint-disable-next-line @typescript-eslint/no-explicit-any at line 254 - test code bypassing type safety.","suggested_fix":"Add explicit type instead of using 'any'. If mock requires flexibility, create a union type or generic interface.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["// eslint-disable-next-line @typescript-eslint/no-explicit-any"]}
