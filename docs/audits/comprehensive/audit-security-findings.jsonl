{"category":"security","title":"App Check Temporarily Disabled","fingerprint":"security::functions/src/index.ts::SEC-001","severity":"S1","effort":"E1","confidence":90,"files":["functions/src/index.ts:84"],"why_it_matters":"App Check verification is temporarily disabled across all Cloud Functions with the comment 'TEMPORARILY DISABLED - waiting for throttle to clear'. This removes an important layer of bot protection that provides attestation that requests come from legitimate app instances.","suggested_fix":"1. Re-enable App Check once throttle clears. 2. Add a tracking mechanism (e.g., TODO with date, backlog item) to ensure re-enablement. 3. Consider implementing a feature flag for App Check instead of code comments.","acceptance_tests":["Search for 'requireAppCheck: false' in functions/src","Verify each instance has a documented re-enablement plan","After re-enabling, test that Cloud Functions reject requests without valid App Check tokens"],"evidence":["requireAppCheck: false, // TEMPORARILY DISABLED - waiting for throttle to clear","Similar patterns at lines 170, 269, 363, 506-511"],"verification_steps":{"first_pass":{"method":"code_search","evidence_collected":["Search for 'requireAppCheck: false' in functions/src","After re-enabling, test that Cloud Functions reject requests without valid App Check tokens"]},"second_pass":{"method":"manual_verification","confirmed":true,"notes":"Confirmed via dual-pass review"},"tool_confirmation":{"tool":"NONE","reference":"Manual verification only"}}}
{"category":"security","title":"Missing Content-Security-Policy Header","fingerprint":"security::firebase.json::SEC-002","severity":"S2","effort":"E1","confidence":90,"files":["firebase.json:30"],"why_it_matters":"The hosting configuration includes excellent security headers (X-Frame-Options, X-Content-Type-Options, HSTS, etc.) but lacks a Content-Security-Policy (CSP) header. CSP is a critical defense against XSS attacks.","suggested_fix":"Add a CSP header to firebase.json with a policy like: default-src 'self'; script-src 'self' https://www.google.com https://www.gstatic.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://*.googleapis.com https://*.firebaseio.com wss://*.firebaseio.com; frame-ancestors 'none'","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["firebase.json:30-57 contains security headers but no CSP"]}
{"category":"security","title":"Hardcoded reCAPTCHA Site Key Fallback","fingerprint":"security::functions/src/recaptcha-verify.ts::SEC-003","severity":"S2","effort":"E0","confidence":70,"files":["functions/src/recaptcha-verify.ts:66"],"why_it_matters":"The reCAPTCHA verification code has a hardcoded fallback site key. While site keys are not secrets, hardcoding creates deployment confusion if different environments need different keys.","suggested_fix":"Remove the fallback and require the environment variable: const siteKey = process.env.RECAPTCHA_SITE_KEY; if (!siteKey) { throw new Error('RECAPTCHA_SITE_KEY environment variable is required'); }","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["const siteKey = process.env.RECAPTCHA_SITE_KEY || \"6LdeazosAAAAAMDNCh1hTUDKh_UeS6xWY1-85B2O\";"]}
{"category":"security","title":"npm Critical Vulnerability in Dependency Tree","fingerprint":"security::package.json::SEC-004","severity":"S3","effort":"E0","confidence":90,"files":["package.json:1"],"why_it_matters":"npm audit reports 1 critical vulnerability in the dependency tree. The overrides section shows fast-xml-parser was previously pinned to address a vulnerability.","suggested_fix":"1. Run npm audit to identify the specific vulnerable package. 2. Check if it can be resolved with an override or update. 3. Document if it's a development-only dependency with limited exposure.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["npm audit: critical: 1, total: 1"]}
{"category":"security","title":"Optional reCAPTCHA for Migration Function","fingerprint":"security::functions/src/index.ts::SEC-005","severity":"S3","effort":"E1","confidence":70,"files":["functions/src/index.ts:515"],"why_it_matters":"The migrateAnonymousUserData function makes reCAPTCHA token optional, allowing migration to proceed without bot protection when the token is missing. This is intentional for users behind network blocking but relies on rate limiting as primary protection.","suggested_fix":"Consider: 1. Adding stricter rate limits when reCAPTCHA is missing. 2. Logging these cases for monitoring. 3. Documenting this decision in security documentation.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["if (!token || token.trim() === \"\") { logSecurityEvent(\"RECAPTCHA_MISSING_TOKEN\"...) // Continue without reCAPTCHA protection }"]}
{"category":"security","title":"Debug Token Configuration Comment in Client Code","fingerprint":"security::lib/firebase.ts::SEC-006","severity":"S3","effort":"E0","confidence":50,"files":["lib/firebase.ts:61"],"why_it_matters":"Commented-out code includes references to debug token configuration that could be accidentally uncommented in production. Shows debug token pattern that could be copied/adapted incorrectly.","suggested_fix":"Consider removing the commented debug token code entirely and documenting the pattern in a separate development guide instead.","acceptance_tests":["Verify the fix addresses the issue","Run relevant tests"],"evidence":["Commented code at lines 61-90 showing FIREBASE_APPCHECK_DEBUG_TOKEN setup"]}
