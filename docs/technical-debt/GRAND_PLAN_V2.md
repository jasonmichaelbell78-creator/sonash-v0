# Grand Plan V2: Technical Debt Elimination

<!-- prettier-ignore-start -->
**Document Version:** 2.0
**Last Updated:** 2026-02-23
**Status:** ACTIVE
**Generated by:** `scripts/debt/generate-grand-plan.js`
<!-- prettier-ignore-end -->

## Purpose

This document is the authoritative plan for eliminating technical debt tracked
in `MASTER_DEBT.jsonl`. It assigns every open item to either a Grand Plan sprint
or a Roadmap track, ensuring 100% coverage with zero unplaced items.

## Overview

- **Total items in MASTER_DEBT**: 4576
- **Grand Plan items**: 3665 across 21 sprints
- **Roadmap-bound items**: 576 (security/enhancements/performance)
- **Completed**: 486 resolved + false-positive (sprints 1-3 scope: 1057 items)
- **Resolution rate**: 5%

## Decision Record

| Decision               | Choice                                                                                       |
| ---------------------- | -------------------------------------------------------------------------------------------- |
| Grand Plan scope       | code-quality, documentation, process, refactoring, engineering-productivity, ai-optimization |
| Roadmap scope          | security, enhancements, performance                                                          |
| Sprint structure       | File-based. Sprints 1-3 done. 4 active. 14 planned.                                          |
| Single source of truth | MASTER_DEBT.jsonl                                                                            |
| Severity scale         | S0 (critical) > S1 (high) > S2 (medium) > S3 (low)                                           |
| Resolution workflow    | Fix item, run `resolve-item.js`, regenerate metrics                                          |

## Sprint Summary

| Sprint     | Focus                                               | Items | S0  | S1  | S2  | S3  | Status   |
| ---------- | --------------------------------------------------- | ----- | --- | --- | --- | --- | -------- |
| sprint-1   | scripts/ (core)                                     | 512   | 2   | 102 | 298 | 110 | COMPLETE |
| sprint-2   | components/                                         | 334   | 0   | 46  | 127 | 161 | COMPLETE |
| sprint-3   | docs/ + .claude/ + root .md                         | 211   | 2   | 22  | 108 | 79  | COMPLETE |
| sprint-4   | lib/ + hooks/ + app/ + styles/ + types/             | 132   | 0   | 28  | 62  | 42  | ACTIVE   |
| sprint-5   | .github/ + .husky/ + config files                   | 66    | 3   | 17  | 29  | 17  | ACTIVE   |
| sprint-6   | functions/ + firestore.rules                        | 54    | 0   | 15  | 21  | 18  | ACTIVE   |
| sprint-7   | tests/ + systemic                                   | 129   | 0   | 33  | 79  | 17  | ACTIVE   |
| sprint-8a  | scripts/ overflow                                   | 200   | 0   | 50  | 113 | 37  | PLANNED  |
| sprint-8b  | scripts/ overflow                                   | 200   | 1   | 84  | 108 | 7   | PLANNED  |
| sprint-8c  | scripts/ overflow                                   | 200   | 0   | 28  | 137 | 35  | PLANNED  |
| sprint-8d  | scripts/ overflow                                   | 160   | 0   | 3   | 10  | 147 | PLANNED  |
| sprint-9a  | .claude/ and docs/                                  | 200   | 0   | 4   | 75  | 121 | PLANNED  |
| sprint-9b  | .claude/ and docs/                                  | 56    | 1   | 14  | 19  | 22  | PLANNED  |
| sprint-10  | .github/, .husky/, root config files                | 117   | 1   | 7   | 35  | 74  | PLANNED  |
| sprint-11a | components/, app/, lib/, functions/, hooks/, types/ | 200   | 2   | 54  | 71  | 73  | PLANNED  |
| sprint-11b | components/, app/, lib/, functions/, hooks/, types/ | 194   | 0   | 34  | 96  | 64  | PLANNED  |
| sprint-11c | components/, app/, lib/, functions/, hooks/, types/ | 77    | 0   | 9   | 11  | 57  | PLANNED  |
| sprint-12a | Cross-cutting items (no specific file)              | 200   | 1   | 22  | 42  | 135 | PLANNED  |
| sprint-12b | Cross-cutting items (no specific file)              | 200   | 0   | 2   | 43  | 155 | PLANNED  |
| sprint-12c | Cross-cutting items (no specific file)              | 200   | 0   | 4   | 34  | 162 | PLANNED  |
| sprint-12d | Cross-cutting items (no specific file)              | 23    | 0   | 1   | 3   | 19  | PLANNED  |

## Sprint Details

### Sprints 1, 2, 3 (COMPLETE)

- **sprint-1**: scripts/ (core) (512 items — S0: 2, S1: 102, S2: 298, S3: 110)
- **sprint-2**: components/ (334 items — S1: 46, S2: 127, S3: 161)
- **sprint-3**: docs/ + .claude/ + root .md (211 items — S0: 2, S1: 22, S2: 108,
  S3: 79)

### sprint-4: lib/ + hooks/ + app/ + styles/ + types/

- **Status**: ACTIVE
- **Items**: 132
- **Severity**: S0: 0, S1: 28, S2: 62, S3: 42

**Top critical items:**

- `DEBT-0009` [S1] Use '[[' instead of '[' for conditional tests. The '[['
  construct is safer and m —
  `.claude/skills/systematic-debugging/find-polluter.sh`
- `DEBT-0010` [S1] Exporting mutable 'let' binding, use 'const' instead. —
  `lib/firebase.ts`
- `DEBT-0014` [S1] Refactor this function to reduce its Cognitive Complexity
  from 18 to the 15 allo — `functions/src/index.ts`
- `DEBT-0042` [S1] Refactor this function to reduce its Cognitive Complexity
  from 18 to the 15 allo — `components/notebook/pages/today-page.tsx`
- `DEBT-0048` [S1] Time-of-day rotation logic duplicated in quotes.ts and
  slogans.ts — `lib/db/quotes.ts`

### sprint-5: .github/ + .husky/ + config files

- **Status**: ACTIVE
- **Items**: 66
- **Severity**: S0: 3, S1: 17, S2: 29, S3: 17

**Top critical items:**

- `DEBT-2458` [S0] SESSION_CONTEXT.md Session Counter Regex in 5 hooks —
  `.claude/hooks/commit-tracker.js`
- `DEBT-2459` [S0] SESSION_DECISIONS.md Decision Block Regex in
  auto-save-context.js — `.claude/hooks/auto-save-context.js`
- `DEBT-2468` [S0] SoNash_Technical_Ideation_Multi_AI 1.20.26.md - 4.1KB
  ideation document never li —
  `docs/SoNash_Technical_Ideation_Multi_AI 1.20.26.md`
- `DEBT-0057` [S1] Automation scripts have critically low test coverage (2-7% of
  ~31 scripts) — `scripts/`
- `DEBT-0058` [S1] Missing security scanning in CI (npm audit, CodeQL,
  Dependabot) — `.github/workflows/ci.yml`

### sprint-6: functions/ + firestore.rules

- **Status**: ACTIVE
- **Items**: 54
- **Severity**: S0: 0, S1: 15, S2: 21, S3: 18

**Top critical items:**

- `DEBT-0012` [S1] Refactor this function to reduce its Cognitive Complexity
  from 16 to the 15 allo — `components/admin/admin-crud-table.tsx`
- `DEBT-0013` [S1] Refactor this function to reduce its Cognitive Complexity
  from 22 to the 15 allo — `functions/src/admin.ts`
- `DEBT-0035` [S1] Refactor this function to reduce its Cognitive Complexity
  from 16 to the 15 allo — `scripts/update-readme-status.js`
- `DEBT-0045` [S1] Refactor this function to reduce its Cognitive Complexity
  from 20 to the 15 allo — `components/growth/NightReviewCard.tsx`
- `DEBT-0051` [S1] No test coverage for high-complexity scripts —
  `scripts/assign-review-tier.js`

### sprint-7: tests/ + systemic

- **Status**: ACTIVE
- **Items**: 129
- **Severity**: S0: 0, S1: 33, S2: 79, S3: 17

**Top critical items:**

- `DEBT-0100` [S1] No Firebase persistence enabled - Firestore cache not
  persisted — `lib/firebase.ts`
- `DEBT-0104` [S1] Fix journal entry type mismatch — `(no file)`
- `DEBT-0105` [S1] Extract error handling utility — `(no file)`
- `DEBT-0106` [S1] Remove deprecated saveNotebookJournalEntry — `(no file)`
- `DEBT-0113` [S1] Separate domain/transport in useJournal — `(no file)`

### sprint-8a: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 50, S2: 113, S3: 37

### sprint-8b: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 1, S1: 84, S2: 108, S3: 7

### sprint-8c: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 28, S2: 137, S3: 35

### sprint-8d: scripts/ overflow

- **Status**: PLANNED
- **Items**: 160
- **Severity**: S1: 3, S2: 10, S3: 147

### sprint-9a: .claude/ and docs/

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 4, S2: 75, S3: 121

### sprint-9b: .claude/ and docs/

- **Status**: PLANNED
- **Items**: 56
- **Severity**: S0: 1, S1: 14, S2: 19, S3: 22

### sprint-10: .github/, .husky/, root config files

- **Status**: PLANNED
- **Items**: 117
- **Severity**: S0: 1, S1: 7, S2: 35, S3: 74

### sprint-11a: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 2, S1: 54, S2: 71, S3: 73

### sprint-11b: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 194
- **Severity**: S1: 34, S2: 96, S3: 64

### sprint-11c: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 77
- **Severity**: S1: 9, S2: 11, S3: 57

### sprint-12a: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 1, S1: 22, S2: 42, S3: 135

### sprint-12b: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 2, S2: 43, S3: 155

### sprint-12c: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 4, S2: 34, S3: 162

### sprint-12d: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 23
- **Severity**: S1: 1, S2: 3, S3: 19

## Roadmap-Bound Items

| Category     | Items | Destination | Notes                                   |
| ------------ | ----- | ----------- | --------------------------------------- |
| Security     | 404   | Track-S     | Auth, App Check, input validation       |
| Enhancements | 82    | M3-M10      | Feature requests deferred to milestones |
| Performance  | 90    | M2          | Bundle size, rendering, queries         |

## Coverage Report

- Total open items: 4090
- Placed in Grand Plan: 3665 (89.6%)
- Placed in Roadmap: 576 (14.1%)
- Unplaced: 0 (0.0%)
- EVERY open item has a home

## Execution Strategy

- Sprints execute in order (4 > 5 > 6 > 7 > 8a > 8b > 8c > 8d > 9a > 9b > 10 >
  11a > 11b > 11c > 12a > 12b)
- Each sprint should take 2-4 sessions to complete
- S0/S1 items within each sprint get priority
- Items can be resolved ad-hoc and marked RESOLVED in MASTER_DEBT.jsonl
- Progress tracked via `generate-metrics.js`
- After completing a sprint, re-run this script to update the plan

## Version History

| Version | Date       | Change                                          |
| ------- | ---------- | ----------------------------------------------- |
| 2.0     | 2026-02-23 | Complete rebuild with 4576 items, 100% coverage |
| 1.0     | 2026-01-28 | Original Grand Plan (Sprints 1-7)               |
