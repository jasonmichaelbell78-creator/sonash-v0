# Grand Plan V2: Technical Debt Elimination

<!-- prettier-ignore-start -->
**Document Version:** 2.0
**Last Updated:** 2026-02-21
**Status:** ACTIVE
**Generated by:** `scripts/debt/generate-grand-plan.js`
<!-- prettier-ignore-end -->

## Purpose

This document is the authoritative plan for eliminating technical debt tracked
in `MASTER_DEBT.jsonl`. It assigns every open item to either a Grand Plan sprint
or a Roadmap track, ensuring 100% coverage with zero unplaced items.

## Overview

- **Total items in MASTER_DEBT**: 4075
- **Grand Plan items**: 3155 across 19 sprints
- **Roadmap-bound items**: 435 (security/enhancements/performance)
- **Completed**: 485 resolved + false-positive (sprints 1-3 scope: 1176 items)
- **Resolution rate**: 6%

## Decision Record

| Decision               | Choice                                                                                       |
| ---------------------- | -------------------------------------------------------------------------------------------- |
| Grand Plan scope       | code-quality, documentation, process, refactoring, engineering-productivity, ai-optimization |
| Roadmap scope          | security, enhancements, performance                                                          |
| Sprint structure       | File-based. Sprints 1-3 done. 4 active. 12 planned.                                          |
| Single source of truth | MASTER_DEBT.jsonl                                                                            |
| Severity scale         | S0 (critical) > S1 (high) > S2 (medium) > S3 (low)                                           |
| Resolution workflow    | Fix item, run `resolve-item.js`, regenerate metrics                                          |

## Sprint Summary

| Sprint     | Focus                                               | Items | S0  | S1  | S2  | S3  | Status   |
| ---------- | --------------------------------------------------- | ----- | --- | --- | --- | --- | -------- |
| sprint-1   | scripts/ (core)                                     | 601   | 3   | 100 | 299 | 110 | COMPLETE |
| sprint-2   | components/                                         | 334   | 1   | 45  | 127 | 161 | COMPLETE |
| sprint-3   | docs/ + .claude/ + root .md                         | 241   | 2   | 22  | 108 | 79  | COMPLETE |
| sprint-4   | lib/ + hooks/ + app/ + styles/ + types/             | 132   | 0   | 28  | 63  | 41  | ACTIVE   |
| sprint-5   | .github/ + .husky/ + config files                   | 66    | 3   | 17  | 29  | 17  | ACTIVE   |
| sprint-6   | functions/ + firestore.rules                        | 54    | 1   | 14  | 21  | 18  | ACTIVE   |
| sprint-7   | tests/ + systemic                                   | 129   | 1   | 32  | 79  | 17  | ACTIVE   |
| sprint-8a  | scripts/ overflow                                   | 200   | 1   | 49  | 113 | 37  | PLANNED  |
| sprint-8b  | scripts/ overflow                                   | 200   | 62  | 24  | 107 | 7   | PLANNED  |
| sprint-8c  | scripts/ overflow                                   | 200   | 18  | 10  | 137 | 35  | PLANNED  |
| sprint-8d  | scripts/ overflow                                   | 156   | 0   | 2   | 9   | 145 | PLANNED  |
| sprint-9a  | .claude/ and docs/                                  | 200   | 0   | 4   | 75  | 121 | PLANNED  |
| sprint-9b  | .claude/ and docs/                                  | 42    | 1   | 11  | 11  | 19  | PLANNED  |
| sprint-10  | .github/, .husky/, root config files                | 76    | 1   | 4   | 22  | 49  | PLANNED  |
| sprint-11a | components/, app/, lib/, functions/, hooks/, types/ | 200   | 4   | 52  | 71  | 73  | PLANNED  |
| sprint-11b | components/, app/, lib/, functions/, hooks/, types/ | 200   | 2   | 32  | 97  | 69  | PLANNED  |
| sprint-11c | components/, app/, lib/, functions/, hooks/, types/ | 13    | 0   | 0   | 1   | 12  | PLANNED  |
| sprint-12a | Cross-cutting items (no specific file)              | 200   | 1   | 22  | 42  | 135 | PLANNED  |
| sprint-12b | Cross-cutting items (no specific file)              | 180   | 0   | 1   | 39  | 140 | PLANNED  |

## Sprint Details

### Sprints 1, 2, 3 (COMPLETE)

- **sprint-1**: scripts/ (core) (601 items — S0: 3, S1: 100, S2: 299, S3: 110)
- **sprint-2**: components/ (334 items — S0: 1, S1: 45, S2: 127, S3: 161)
- **sprint-3**: docs/ + .claude/ + root .md (241 items — S0: 2, S1: 22, S2: 108,
  S3: 79)

### sprint-4: lib/ + hooks/ + app/ + styles/ + types/

- **Status**: ACTIVE
- **Items**: 132
- **Severity**: S0: 0, S1: 28, S2: 63, S3: 41

**Top critical items:**

- `DEBT-0009` [S1] Use '[[' instead of '[' for conditional tests. The '[['
  construct is safer and m —
  `.claude/skills/systematic-debugging/find-polluter.sh`
- `DEBT-0010` [S1] Exporting mutable 'let' binding, use 'const' instead. —
  `lib/firebase.ts`
- `DEBT-0014` [S1] Refactor this function to reduce its Cognitive Complexity
  from 18 to the 15 allo — `functions/src/index.ts`
- `DEBT-0042` [S1] Refactor this function to reduce its Cognitive Complexity
  from 18 to the 15 allo — `components/notebook/pages/today-page.tsx`
- `DEBT-0048` [S1] Time-of-day rotation logic duplicated in quotes.ts and
  slogans.ts — `lib/db/quotes.ts`

### sprint-5: .github/ + .husky/ + config files

- **Status**: ACTIVE
- **Items**: 66
- **Severity**: S0: 3, S1: 17, S2: 29, S3: 17

**Top critical items:**

- `DEBT-2458` [S0] SESSION_CONTEXT.md Session Counter Regex in 5 hooks —
  `.claude/hooks/commit-tracker.js`
- `DEBT-2459` [S0] SESSION_DECISIONS.md Decision Block Regex in
  auto-save-context.js — `.claude/hooks/auto-save-context.js`
- `DEBT-2468` [S0] SoNash_Technical_Ideation_Multi_AI 1.20.26.md - 4.1KB
  ideation document never li —
  `docs/SoNash_Technical_Ideation_Multi_AI 1.20.26.md`
- `DEBT-0057` [S1] Automation scripts have critically low test coverage (2-7% of
  ~31 scripts) — `scripts/`
- `DEBT-0058` [S1] Missing security scanning in CI (npm audit, CodeQL,
  Dependabot) — `.github/workflows/ci.yml`

### sprint-6: functions/ + firestore.rules

- **Status**: ACTIVE
- **Items**: 54
- **Severity**: S0: 1, S1: 14, S2: 21, S3: 18

**Top critical items:**

- `DEBT-0013` [S0] Refactor this function to reduce its Cognitive Complexity
  from 22 to the 15 allo — `functions/src/admin.ts`
- `DEBT-0012` [S1] Refactor this function to reduce its Cognitive Complexity
  from 16 to the 15 allo — `components/admin/admin-crud-table.tsx`
- `DEBT-0035` [S1] Refactor this function to reduce its Cognitive Complexity
  from 16 to the 15 allo — `scripts/update-readme-status.js`
- `DEBT-0045` [S1] Refactor this function to reduce its Cognitive Complexity
  from 20 to the 15 allo — `components/growth/NightReviewCard.tsx`
- `DEBT-0051` [S1] No test coverage for high-complexity scripts —
  `scripts/assign-review-tier.js`

### sprint-7: tests/ + systemic

- **Status**: ACTIVE
- **Items**: 129
- **Severity**: S0: 1, S1: 32, S2: 79, S3: 17

**Top critical items:**

- `DEBT-0956` [S0] Refactor this function to reduce its Cognitive Complexity
  from 16 to the 15 allo — `components/admin/errors-tab.tsx`
- `DEBT-0100` [S1] No Firebase persistence enabled - Firestore cache not
  persisted — `lib/firebase.ts`
- `DEBT-0104` [S1] Fix journal entry type mismatch — `(no file)`
- `DEBT-0105` [S1] Extract error handling utility — `(no file)`
- `DEBT-0106` [S1] Remove deprecated saveNotebookJournalEntry — `(no file)`

### sprint-8a: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 1, S1: 49, S2: 113, S3: 37

### sprint-8b: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 62, S1: 24, S2: 107, S3: 7

### sprint-8c: scripts/ overflow

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 18, S1: 10, S2: 137, S3: 35

### sprint-8d: scripts/ overflow

- **Status**: PLANNED
- **Items**: 156
- **Severity**: S1: 2, S2: 9, S3: 145

### sprint-9a: .claude/ and docs/

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S1: 4, S2: 75, S3: 121

### sprint-9b: .claude/ and docs/

- **Status**: PLANNED
- **Items**: 42
- **Severity**: S0: 1, S1: 11, S2: 11, S3: 19

### sprint-10: .github/, .husky/, root config files

- **Status**: PLANNED
- **Items**: 76
- **Severity**: S0: 1, S1: 4, S2: 22, S3: 49

### sprint-11a: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 4, S1: 52, S2: 71, S3: 73

### sprint-11b: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 2, S1: 32, S2: 97, S3: 69

### sprint-11c: components/, app/, lib/, functions/, hooks/, types/

- **Status**: PLANNED
- **Items**: 13
- **Severity**: S2: 1, S3: 12

### sprint-12a: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 200
- **Severity**: S0: 1, S1: 22, S2: 42, S3: 135

### sprint-12b: Cross-cutting items (no specific file)

- **Status**: PLANNED
- **Items**: 180
- **Severity**: S1: 1, S2: 39, S3: 140

## Roadmap-Bound Items

| Category     | Items | Destination | Notes                                   |
| ------------ | ----- | ----------- | --------------------------------------- |
| Security     | 346   | Track-S     | Auth, App Check, input validation       |
| Enhancements | 12    | M3-M10      | Feature requests deferred to milestones |
| Performance  | 77    | M2          | Bundle size, rendering, queries         |

## Coverage Report

- Total open items: 3590
- Placed in Grand Plan: 3155 (87.9%)
- Placed in Roadmap: 435 (12.1%)
- Unplaced: 0 (0%)
- EVERY open item has a home

## Execution Strategy

- Sprints execute in order (4 > 5 > 6 > 7 > 8a > 8b > 8c > 8d > 9a > 9b > 10 >
  11a > 11b > 11c > 12a > 12b)
- Each sprint should take 2-4 sessions to complete
- S0/S1 items within each sprint get priority
- Items can be resolved ad-hoc and marked RESOLVED in MASTER_DEBT.jsonl
- Progress tracked via `generate-metrics.js`
- After completing a sprint, re-run this script to update the plan

## Version History

| Version | Date       | Change                                          |
| ------- | ---------- | ----------------------------------------------- |
| 2.0     | 2026-02-21 | Complete rebuild with 4075 items, 100% coverage |
| 1.0     | 2026-01-28 | Original Grand Plan (Sprints 1-7)               |
